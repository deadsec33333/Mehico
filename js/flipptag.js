window.flippxp = window.flippxp || {}; window.flippxp.settings = {"disableLazyLoading":false,"dtx-rebuild":false,"dwellExpandable":false,"enableOptimizedShimmer":false,"expandOnReadMore":true,"gamContainerWidth":-1,"rootElement":"","singlePageApp":false,"test-feedel":false,"wideCompact":false,"wideCompactBackgroundColor":""}; window.flippxp.useragent = {"browser":"Safari","browserVersion":"17.2.1","system":"Mac OS X","systemModel":"Apple","systemVersion":"10.15.7","type":"desktop"}; window.flippxp.geo = {"country":"RU","ip":"62.133.61.131"};
!function(){"use strict";let e=(e,t,n)=>{let i=t.getBoundingClientRect(),o={top:i.top,height:i.height,bottom:i.bottom};if(n!==t.ownerDocument.defaultView){let t=e.getBoundingClientRect();o.top=t.top+i.top,o.height=Math.min(o.height,t.height),o.bottom=o.top+o.height}if(0===o.height)return null;let r=o.height,s=0;return o.top>n.innerHeight||o.bottom<=0?{top:0,height:0,screenHeight:n.innerHeight}:(o.top<0&&(r-=s=-o.top),o.bottom>n.innerHeight&&(r-=o.bottom-n.innerHeight),{top:s,height:r=Math.max(r,0),screenHeight:n.innerHeight})};(t=d||(d={})).FlippApp="FlippApp",t.ReebeeApp="ReebeeApp",t.FlippWeb="FlippWeb",t.Flyers="Flyers",t.Hosted="Hosted",t.GMA="GMA",t.Editorials="Editorials",t.Hero="Hero",t.ShopperPlatform="ShopperPlatform",t.FlippPlatformSdk="FlippPlatformSdk",t.Other="Other",t.FlippAvroDefault="FlippAvroDefault",(n=c||(c={})).Prod="Prod",n.Dev="Dev",n.Test="Test",(i=p||(p={})).StorefrontInline="StorefrontInline",i.StorefrontExpanded="StorefrontExpanded",i.UlpInline="UlpInline",i.UlpExpanded="UlpExpanded",(o=u||(u={})).Default="Default",o.Safeframe="Safeframe",o.Enabler="Enabler",o.WebView="WebView",(r=h||(h={})).Compact="Compact",r.Classic="Classic",r.MultiStandard="MultiStandard",r.Unknown="Unknown",(s=m||(m={})).Desktop="Desktop",s.Mobile="Mobile",s.Tablet="Tablet",(a=f||(f={})).CA="CA",a.US="US",a.Other="Other",(l=g||(g={})).Flyer="Flyer",l.Merchant="Merchant",l.Ecom="Ecom";var t,n,i,o,r,s,a,l,d,c,p,u,h,m,f,g,v,y,I,b,w,E,x,C,k,S,M,T,N,P,_,A,O,R,q,z,L,D,U,F,H=Object.freeze({__proto__:null,AppInitializedSchemaId:5221,get ApplicationID(){return d},BiddingBidRequestSchemaId:5244,BiddingCallBidderSchemaId:5240,BiddingHeaderLoadedSchemaId:5239,BiddingResponseFailureSchemaId:5242,BiddingResponseSuccessSchemaId:5241,BiddingServerSubmitBidSchemaId:5245,BiddingWonAuctionSchemaId:5243,BoomboxRulesMatchSchemaId:5246,get Country(){return f},DecisionRequestContextSchemaId:5222,DecisionRequestMadeSchemaId:5223,DecisionResponseFailureSchemaId:5225,DecisionResponseSuccessSchemaId:5224,get Environment(){return c},ExperienceInViewFlyerSchemaId:5210,ExperienceMeasuredTestSchemaId:5237,ExperienceScrolledBeyondSlotSchemaId:5211,ExperienceServedFallbackSchemaId:5209,get ExperienceType(){return h},ItemDetailsClickSaveSchemaId:5220,ItemDetailsClickTransferToMerchantSchemaId:5219,get ItemType(){return g},LandingClickSeeFullPageSchemaId:5234,LandingEngagedVisitPageSchemaId:5232,LandingHeartbeatPageSchemaId:5226,LandingImpressionItemSchemaId:5233,LandingInViewSchemaId:5227,LandingItemClickSaveSchemaId:5230,LandingItemClickSchemaId:5229,LandingItemClickTransferToMerchantSchemaId:5231,LandingOpenPageSchemaId:5228,get Platform(){return m},get ShopperPlatformAdView(){return u},get ShopperPlatformUx(){return p},SlotImpressionExperienceSchemaId:5238,StorefrontClickFlyerItemDetailsSchemaId:5216,StorefrontClickSeeFullFlyerSchemaId:5217,StorefrontClickSkipFlyerSchemaId:5218,StorefrontEngagedVisitFlyerSchemaId:5214,StorefrontHeartbeatFlyerSchemaId:5212,StorefrontImpressionFlyerItemSchemaId:5215,StorefrontOpenFlyerSchemaId:5213,SurveyClickSchemaId:5236,SurveyOpenSchemaId:5235}),B=function(e,t){return(B=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},j=function(){return(j=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function W(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}function V(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(l){return function(a){if(n)throw TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}"function"==typeof SuppressedError&&SuppressedError,(A=v||(v={})).PIXEL="pixel",A.SCRIPT="script";var G=new(function(){function e(){}return e.prototype.debug=function(){return null},e.prototype.warn=function(e){return console.warn(e),null},e.prototype.error=function(e,t){return console.error(e,t),null},e}()),K=function(e){return e instanceof Error?Y(e.message,e.stack):Y(JSON.stringify(e),Error().stack),null},Y=function(e,t,n,i){return W(void 0,void 0,void 0,function(){var o,r;return V(this,function(s){switch(s.label){case 0:if((o={service:null!=i?i:"shopper-ad-web",type:"error",message:e,stack:t||"",userAgent:window.navigator.userAgent,host:n||function(){if(window.top&&window.top!==window)try{return window.top.location.href}catch(e){}if(window.parent&&window.parent!==window)try{return window.parent.location.href}catch(e){return document.referrer}return window.location.href}()}).userAgent.includes("bot"))return G.debug("Bot detected. Not Sent Error: ",o),[2,null];G.debug("Send Error: ",o),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch("https://frontend-logger.flippback.com/api/logging",{method:"POST",headers:{"Content-Type":"text/plain; charset=UTF-8"},body:JSON.stringify(o)})];case 2:return s.sent(),[3,4];case 3:return(r=s.sent())instanceof Error&&G.error("Error when sending error",r),[3,4];case 4:return[2,null]}})})},$="https://p.flipp.com/beacons",J=new(function(){function e(){var e=this;this.queue=[],this.beaconErrors=0,this.isFlushing=!1,this.prodAnalytics=!1,this.sendBeaconBeforeHidden=function(){e.queue.length&&navigator.sendBeacon($,encodeURIComponent(JSON.stringify(e.queue)))}}return e.prototype.enqueue=function(e){if(!e)return null;this.queue.push(e),this.checkQueue()},e.prototype.start=function(){return this.checkQueue(),null},e.prototype.checkQueue=function(){!this.isFlushing&&this.queue.length&&(this.isFlushing=!0,this.flushQueue())},e.prototype.flushQueue=function(){return W(this,void 0,void 0,function(){var e,t,n,i,o;return V(this,function(r){switch(r.label){case 0:if(!this.queue.length)return this.isFlushing=!1,[2,null];for(e=encodeURIComponent(JSON.stringify(this.queue)),t=[];new Blob([e]).size>204800;)(n=this.queue.pop())&&t.push(n),e=encodeURIComponent(JSON.stringify(this.queue));G.debug("Flushing analytics queue",this.queue),i=function(e,t,n){if(n||2==arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}([],this.queue,!0),this.queue=[],t.length&&(this.queue=t.concat(this.queue)),r.label=1;case 1:return r.trys.push([1,6,,7]),[4,this.sendBeacon(e)];case 2:if(r.sent(),!(this.queue.length>0))return[3,4];return[4,this.flushQueue()];case 3:return r.sent(),[3,5];case 4:this.isFlushing=!1,r.label=5;case 5:return[3,7];case 6:return o=r.sent(),this.beaconErrors+=1,this.queue=i.concat(this.queue),this.isFlushing=!1,o instanceof Error&&this.beaconErrors<=1&&Y("Unhandled Rejection: ".concat(o.message),o.stack,"shopper-ad-web-blocked-beacon","shopper-ad-web-blocked-beacon"),[3,7];case 7:return[2]}})})},e.prototype.sendBeacon=function(e){return this.prodAnalytics&&fetch("https://holodeck.flippback.com/json-beacon/v1/nativex",{method:"POST",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},body:e}),fetch($,{method:"POST",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},body:e})},e}());J.start();var X=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},Q=((y={})[v.PIXEL]=function(e,t){if(!e)return null;try{var n,i=e.replace(/\[\[random\]\]/g,Math.floor(1e7+9e7*Math.random()).toString());n=new URL(i)}catch(t){return console.error("Invalid pixel url: ".concat(e)),null}if(t)for(var o in t)n.searchParams.set(o,t[o]);return new Image(1,1).src=n.toString(),null},y[v.SCRIPT]=function(e){var t=document.createElement("script");return t.innerHTML=e,t.id=X(),document.body.append(t),t.remove(),null},y),Z=function(e,t,n){return Q[e](t,n),null},ee=function(){function e(){var e=this;this.processedTags=[],this.sent={open:!1,engagement:!1,impression:!1},this.addTagsFromCampaignResponse=function(t,n,i){var o=e.buildTags(t,i);return e.addTags(o,n),null},this.addTags=function(t,n){return e.parseTags(t),e.payload=n,null},this.sendOpen=function(){return e.sent.open||(G.debug("Tags: Send open"),e.send("open"),e.sent.open=!0),null},this.sendEngagement=function(){return e.sent.engagement||(G.debug("Tags: Send engagement"),e.send("engagement"),e.sent.engagement=!0),null},this.sendClick=function(t){return G.debug("Tags: Send click"),e.send("click",{flyerItemId:t}),null},this.sendServedImpression=function(){return e.sent.impression||(G.debug("Tags: Send served impression"),e.send("impression"),e.sent.impression=!0),null},this.sendAnswerClick=function(t){return G.debug("Tags: Send Survey click: "+t),e.send("engagement",{answer:t}),null},this.reset=function(){return e.sent.open=!1,e.sent.engagement=!1,e.sent.impression=!1,e.processedTags=[],e.payload=void 0,null},this.send=function(t,n){return e.processedTags.filter(function(e){return e.event===t}).forEach(function(e){return Z(e.type,e.content,n)}),null}}return e.prototype.buildTags=function(e,t){var n,i;return j(j({},null===(i=null===(n=e.storefront)||void 0===n?void 0:n.campaignConfig)||void 0===i?void 0:i.tags),{campaignManagement:{open:[e.impressionUrl],engagement:[e.clickUrl],impression:[]}})},e.prototype.parseTags=function(e){var t,n=this,i=function(i){var o=function(o){var r=v.PIXEL,s=null===(t=e[i])||void 0===t?void 0:t[o];if(!s)return"continue";Array.isArray(s)||(s=[s]),s.forEach(function(e){var t="";"string"!=typeof e?(r=e.type,t=e.content):t=e,n.processedTags.push({type:r,source:i,event:o,content:t})})};for(var r in e[i])o(r)};for(var o in e)i(o)},e}(),et=null,en=function(e){window.flippxp&&!window.flippxp.cookieSynced&&setTimeout(function(){var t=new Image;t.src="https://idsync.rlcdn.com/712559.gif?partner_uid=".concat(e),window.flippxp.cookieSynced=!0,t.remove()},1)};function ei(e){if(void 0===e&&(e={}),et)return en(et),et;if("userKey"in e&&e.userKey&&!e.userKey.startsWith("#"))return en(et=e.userKey),e.userKey;for(var t="flipp-uid",n=null,i=document.cookie.split(";"),o=0;o<i.length;o++){var r=i[o].split("="),s=r[0],a=r[1];if(s.trim()===t){n=a;break}}return n?(en(n),n):(et=X())?(document.cookie=t+"="+et+"; max-age=31536000; path=/",en(et),et):null}var eo={},er="UNKNOWN",es=function(){var e=window.screen.width||document.documentElement.clientWidth||document.body.clientWidth,t=window.screen.height||document.documentElement.clientHeight||document.body.clientHeight;return e>=1024&&t>=768?"desktop":e>=768&&t>=1024?"tablet":"mobile"},ea=function(){if(null===(e=window.flippxp)||void 0===e?void 0:e.useragent)return{browser:null===(n=null===(t=window.flippxp)||void 0===t?void 0:t.useragent)||void 0===n?void 0:n.browser,browserVersion:null===(o=null===(i=window.flippxp)||void 0===i?void 0:i.useragent)||void 0===o?void 0:o.browserVersion,system:null===(s=null===(r=window.flippxp)||void 0===r?void 0:r.useragent)||void 0===s?void 0:s.system,systemModel:null===(l=null===(a=window.flippxp)||void 0===a?void 0:a.useragent)||void 0===l?void 0:l.systemModel,systemVersion:null===(c=null===(d=window.flippxp)||void 0===d?void 0:d.useragent)||void 0===c?void 0:c.systemVersion,type:"mobile"!==(h=null===(u=null===(p=window.flippxp)||void 0===p?void 0:p.useragent)||void 0===u?void 0:u.type)?es():h};var e,t,n,i,o,r,s,a,l,d,c,p,u,h,m=new eo().getResult(),f=m.browser,g=m.os,v=m.device;return{browser:f.name,browserVersion:f.version,system:g.name,systemModel:v.vendor,systemVersion:g.version,type:v.type||"desktop"}},el=new(function(){function e(){}return e.prototype.getDeviceInfo=function(e){if(this.deviceInfo)return this.deviceInfo;var t=ea(),n=t.browser,i=t.browserVersion,o=t.system,r=t.systemModel,s=t.systemVersion,a=t.type;return this.deviceInfo=j({browser:n||er,browserVersion:i||"NA",devicePixelRatio:Math.round(1e3*window.devicePixelRatio)||0,host:document.referrer,iframeWidth:window.innerWidth,screenHeight:window.screen.height,screenWidth:window.screen.width,system:o||er,systemModel:r||er,systemVersion:s||"NA",type:a||"desktop"},e),this.deviceInfo},e}()),ed=function(e,t){if(void 0===t&&(t=-1),"number"==typeof e)return e;if("string"==typeof e){var n=parseInt(e,10);return isNaN(n)?t:n}return t};function ec(e){switch(!0){case!!e.sdkConfig:return x.SDK;case!!e.prebid:return x.PREBID;case!!e.nestedIframe:return x.NESTED_IFRAME;case!!e.isGoogleAmp:return x.GOOGLE_AMP;case!!e.standalone:return x.STANDALONE;case!!e.dtx:return x.DTX;case!!e.openrtb:return x.OPENRTB;default:return x.NATIVE}}(O=I||(I={})).INLINE="inline",O.DEFAULT="default",O.ULP="ulp",O.SURVEY="survey",(R=b||(b={})).SafeFrame="safeframe",R.Native="native",(q=w||(w={})).SCROLL="scroll",q.ENGAGEMENT="engagement",q.OPEN="open",q.HEARTBEAT="heartbeat",(z=E||(E={})).Compact="Compact",z.Classic="Classic",z.MultiStandard="MultiStandard",z.Unknown="Unknown",(L=x||(x={})).SDK="sdk",L.PREBID="prebid",L.NESTED_IFRAME="nestedIframe",L.GOOGLE_AMP="googleAmp",L.STANDALONE="standalone",L.DTX="dtx",L.NATIVE="native",L.OPENRTB="openrtb";var ep=0,eu=X(),eh=[5240,5239,5242,5241,5243],em=null,ef=function(){if(!em)switch(el.getDeviceInfo().type){case"mobile":em={"com.flipp.beacon.shopperPlatform.enumeration.Platform":m.Mobile};break;case"tablet":em={"com.flipp.beacon.shopperPlatform.enumeration.Platform":m.Tablet};break;case"desktop":em={"com.flipp.beacon.shopperPlatform.enumeration.Platform":m.Desktop};break;default:em=null}return em};function eg(e){return"CA"===e?{"com.flipp.beacon.shopperPlatform.enumeration.Country":f.CA}:"US"===e?{"com.flipp.beacon.shopperPlatform.enumeration.Country":f.US}:null}function ev(){var e;return null===(e=window.flippxp.geo)||void 0===e?void 0:e.postal_code}function ey(){var e;return null===(e=window.flippxp.geo)||void 0===e?void 0:e.country}function eI(e){return e?{"com.flipp.beacon.shopperPlatform.entity.ShopperPlatformDecision":e}:null}var eb=function(e){var t,n,i,o,r,s,a,l,m,f,g,v,y,I,b,w,E,x,C=e.schemaId,k=e.partnerNameIdentifier,S=e.siteId,M=e.zoneId,T=e.options,N=e.postalCode,P=e.campaignNameIdentifier,_=e.shopperPlatformUx,A=T.startCompact?h.Compact:h.Classic,O=eh.includes(C),R=new URLSearchParams(window.location.search).get("site");return{base:{aid:d.ShopperPlatform,rnd:Math.random().toString(),postalCode:N?{string:N}:null},shopperPlatformBase:(n=(t={usedFallbackPostalCode:!1,sessionId:eu,appVersion:"1.47.0",shopperPlatformCampaign:{partnerNameIdentifier:k||"",campaignNameIdentifier:P||""},shopperPlatformConfig:{openViewRatio:0,openTimerMs:0,evTimerMs:0},shopperPlatformUx:null!=_?_:p.StorefrontInline,site:null!==(E=null!=R?R:T.overrideHostname)&&void 0!==E?E:window.location.hostname,uid:ei(T)||"unknown",experienceType:O?h.Unknown:A,integrationType:ec(T),auctionId:null===(x=T.prebid)||void 0===x?void 0:x.requestId,mediaPartnerDescriptiveValueTag:T.mediaPartnerDescriptiveValueTag}).usedFallbackPostalCode,i=t.sessionId,o=t.appVersion,r=t.shopperPlatformCampaign,s=t.shopperPlatformConfig,a=t.shopperPlatformUx,l=t.site,m=t.uid,f=t.experienceType,g=t.integrationType,v=t.auctionId,y=t.mediaPartnerDescriptiveValueTag,I=el.getDeviceInfo().devicePixelRatio,{integrationType:g,experienceType:f,environment:c.Prod,clientParameters:{browser:(b=el.getDeviceInfo()).browser,browserVersion:b.browserVersion,system:b.system,systemModel:b.systemModel,systemVersion:b.systemVersion},epochMilliseconds:Date.now(),uuid:X(),usedFallbackPostalCode:n,sessionId:i,sequenceId:ep++,viewSize:{viewWidth:(w=el.getDeviceInfo()).screenWidth,viewHeight:w.screenHeight},devicePixelRatio:I,appVersion:o,shopperPlatformCampaign:r,shopperPlatformConfig:s,shopperPlatformUx:a,shopperPlatformAdView:u.Default,site:l,uid:m,auctionId:void 0===v?"FlippAvroDefault":v,mediaPartnerDescriptiveValueTag:y?{string:y}:null}),siteId:ed(S),zoneId:ed(M),schemaInfo:{schemaId:C,schemaName:null},platform:ef()}},ew=function(e){var t=e.partnerNameIdentifier,n=e.siteId,i=e.zoneId,o=e.options,r=e.postalCode,s=e.country;return j({},eb({partnerNameIdentifier:t,siteId:n,zoneId:i,options:o,schemaId:5221,postalCode:r,country:s}))},eE=function(e){var t,n=e.partnerNameIdentifier,i=e.siteId,o=e.zoneId,r=e.country,s=e.postalCode,a=e.keywords,l=e.category,d=e.pageUrl,c=e.queryParams,p=e.options,u=j(j({},eb({partnerNameIdentifier:n,siteId:i,zoneId:o,options:p,postalCode:s,schemaId:5222})),{country:eg(r),keywords:a,category:l,pageUrl:d,queryParams:c.map(function(e){return{paramName:e[0],paramValue:e[1]}}),referrer:"FlippAvroDefault"}),h=new URL(window.location.toString()),m=null!==(t=h.searchParams.get("utm_source"))&&void 0!==t?t:h.searchParams.get("referrer");return m&&m.length>0&&(u.referrer=m),u},ex=function(e){var t=e.partnerNameIdentifier,n=e.siteId,i=e.zoneId,o=e.country,r=e.postalCode,s=e.options;return j(j({},eb({partnerNameIdentifier:t,siteId:n,zoneId:i,postalCode:r,options:s,schemaId:5223})),{country:eg(o)})},eC=function(e){var t=e.partnerNameIdentifier,n=e.siteId,i=e.zoneId,o=e.country,r=e.postalCode,s=e.errorMessage,a=e.responseCode,l=e.options;return j(j({},eb({partnerNameIdentifier:t,siteId:n,zoneId:i,options:l,postalCode:r,schemaId:5225})),{country:eg(o),errorMessage:s,responseCode:a})},ek=function(e){var t=e.partnerNameIdentifier,n=e.campaignNameIdentifier,i=e.siteId,o=e.zoneId,r=e.country,s=e.postalCode,a=e.decisions,l=e.options;return j(j({},eb({campaignNameIdentifier:n,partnerNameIdentifier:t,siteId:i,zoneId:o,options:l,postalCode:s,schemaId:5224})),{country:eg(r),decisions:a})},eS=function(e){var t=e.partnerNameIdentifier,n=e.siteId,i=e.zoneId,o=e.options,r=e.cpm,s=e.postalCode,a=e.campaignId;return j(j({},eb({partnerNameIdentifier:t,siteId:n,zoneId:i,options:o,schemaId:5238,postalCode:s})),{CPM:null,float_CPM:r?{float:r}:null,campaignId:a})},eM=["https://di.rlcdn.com/api/segment?pid="],eT=new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.send=function(e,n){return t.processedTags.filter(function(t){return t.event===e}).forEach(function(e){var i=t.extendPayload(e,n);Z(e.type,e.content,i)}),null},t.addTagsFromCampaignResponse=function(e,n,i){var o=t.buildTags(e,i);return t.addTags(o,n),null},t.buildLiveRampTag=function(e,t){var n,i,o,r,s=e.contents[0].data.customData;if(null==s?void 0:s.liveRampTagId){var a=e.campaignId,l=null!==(i=null===(n=e.storefront)||void 0===n?void 0:n.flyer_run_id)&&void 0!==i?i:-1,d=null!==(r=null===(o=e.storefront)||void 0===o?void 0:o.flyer_type_id)&&void 0!==r?r:-1,c=t.postal_code,p=t.country,u=new URLSearchParams({pid:s.liveRampTagId.toString(),pdata:"campaignId=".concat(a,",flyerRunId=").concat(l,",flyerTypeId=").concat(d,",postalCode=").concat(c,",country=").concat(p)});return"https://di.rlcdn.com/api/segment?".concat(u.toString())}return null},t}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}B(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.buildTags=function(t,n){var i,o,r=e.prototype.buildTags.call(this,t,n),s=this.buildLiveRampTag(t,n);return s&&(null===(o=null===(i=r.campaignManagement)||void 0===i?void 0:i.impression)||void 0===o||o.push(s)),r},t.prototype.extendPayload=function(e,t){return this.shouldAttachPayload(e.content)&&(t||(t={}),t.pdata=this.constructPayload(e.event)),t},t.prototype.constructPayload=function(e){var t=ef(),n=t?Object.values(t)[0]:"null",i=this.getExperience();return"event=".concat(e,",platform=").concat(n,",experience=").concat(i)},t.prototype.getExperience=function(){var e;return(null===(e=this.payload)||void 0===e?void 0:e.startCompact)?"compact":"standard"},t.prototype.shouldAttachPayload=function(e){return eM.some(function(t){return e.includes(t)})&&!e.includes("pdata")},t}(ee));(D=C||(C={})).ANALYTICS_CONFIG="analytics-config",D.INLINE_GEOMETRY="inline-geometry",D.SFML_VIEWPORT="sfml-viewport",D.IFRAME_HEIGHT_RESIZE="iframe-height-resize",D.REQUEST_EXPAND="request-expand",D.END_PREVIEW="end-preview",D.COUNTDOWN_STATE="countdown-state",D.ULP="flipp-ulp",D.MEASURE_TEST="measure-test",D.DYNAMIC_HEADER_ITEMS="dynamic-header-items",D.RESIZE_IFRAME="resize-iframe",D.CALLBACK="callback",D.SEND_EV="send-ev",D.VIMP="flipp-vimp",D.CANVASES_MUTATED="canvases-mutated",D.FILMSTRIP_CLICK="filmstrip-click",D.SOME_EVENT="SOME_EVENT";var eN={CLICK_MEATBALL:"CLICK_MEATBALL",SHARE_ITEM:"SHARE_ITEM",SEE_FLYER_ITEM:"SEE_ITEM",CLIP_FLYER_ITEM:"CLIP_ITEM",SEE_MERCHANT_ITEM:"SEE_MERCHANT_ITEM",CLIP_MERCHANT_ITEM:"CLIP_MERCHANT_ITEM",SEE_ECOM_ITEM:"CLICK",CLIP_ECOM_ITEM:"CLIP_ECOM_ITEM",ITEM_IMPRESSION:"ITEM_IMPRESSION",SEE_ALL_DEALS:"SEE_ALL_DEALS",ERROR:"ERROR"},eP=function(){function e(e,t,n,i,o,r){this.emitter=e,this.eventType=t,this.listener=n,this.key=i,this.options=o,this.context=r}return e.prototype.remove=function(){var e=this.emitter.getSubscriptions(this.eventType);return e&&delete e[this.key],null},e}(),e_=function(){function e(){this.subscriptionsForType=new Map}return e.prototype.addListener=function(e,t,n,i){var o,r=null!==(o=this.subscriptionsForType.get(e))&&void 0!==o?o:[],s=new eP(this,e,t,r.length,n,i);return r.push(s),this.subscriptionsForType.set(e,r),s},e.prototype.emit=function(e,t){for(var n,i,o=null!==(n=this.subscriptionsForType.get(e))&&void 0!==n?n:[],r=0;r<o.length;r++){var s=o[r];s.listener.call(s.context,new CustomEvent(e.toString(),{detail:t})),(null===(i=s.options)||void 0===i?void 0:i.once)&&s.remove()}return null},e.prototype.getSubscriptions=function(e){return this.subscriptionsForType.get(e)},e}(),eA="message",eO=new(function(){function e(){var e=this;this.addEventListener=function(t,n,i){var o=e.eventEmmiter.addListener(t,n,i);return(null==i?void 0:i.sendRequest)&&i.target&&e.sendMessage("request-"+t,i.requestData,i.target),o},this.sendMessage=function(e,t,n){return void 0===n&&(n=window),n.postMessage({type:e,data:t},"*"),null},this.handleMessage=function(t){return e.isMessageRelevant(t.data)&&e.eventEmmiter.emit(t.data.type,t.data.data),null},this.isMessageRelevant=function(e){if(!e.type)return!1;for(var t=0,n=Object.values(C);t<n.length;t++)if(n[t]===e.type)return!0;return!1},this.eventEmmiter=new e_,this.start()}return e.prototype.start=function(){return window.addEventListener(eA,this.handleMessage),null},e.prototype.stop=function(){return window.removeEventListener(eA,this.handleMessage),null},e}());(U=k||(k={})).CONTENT_READY="content-ready",U.CONTENT_LOAD_ERROR="content-load-error",U.EXPERIENCE_LOAD="experience-load",U.REQUEST_RESIZE="request-resize",U.REQUEST_GO_TO_URL="request-go-to-url",U.REQUEST_ADD_TO_LIST="request-add-to-list",U.EXPERIENCE_VIEWPORT="experience-viewport";var eR=function(){return T||[]},eq=function(e,t,n){G.debug("Post Message from Webview to SDK",{type:e,detail:t});var i=JSON.stringify({type:e,detail:t});if("ios"===n&&window.webkit)try{window.webkit.messageHandlers.NativeXBridge.postMessage(i)}catch(e){console.error("Error messaging iOS",e)}else if("android"===n&&window.NativeXBridge)try{window.NativeXBridge.postMessage(i)}catch(e){console.error("Error messaging Android",e)}return null},ez=function(e,t,n){var i=window.devicePixelRatio,o={contentType:e,contentHeight:t,height:document.body.offsetHeight,devicePixelRatio:i};return eq(k.CONTENT_READY,o,n),null},eL=function(e){return eq(k.CONTENT_LOAD_ERROR,{text:"Ad content could not be loaded."},e),null},eD=function(e){var t,n=null===(t=document.querySelector("iframe"))||void 0===t?void 0:t.contentWindow,i=e.detail&&"screenHeight"in e.detail?e.detail.screenHeight:window.innerHeight,o=j(j({},e.detail),{screenHeight:i});return N(o),n&&eO.sendMessage(C.INLINE_GEOMETRY,o,n),null},eU=function(e){var t={};return(e.map(function(e){switch(e){case"request-add-to-list":t.addToList=!0;break;case"request-go-to-url":t.goToURL=!0}return null}),0===Object.keys(t).length)?null:t},eF=function(e){var t=j(j({},e.detail),{screenHeight:window.innerHeight});return P(t),null};(F=_||(_={})).CLICK_MEATBALL="CLICK_MEATBALL",F.SHARE_ITEM="SHARE_ITEM",F.SEE_ITEM="SEE_ITEM",F.CLIP_ITEM="CLIP_ITEM",F.SEE_MERCHANT_ITEM="SEE_MERCHANT_ITEM",F.CLIP_MERCHANT_ITEM="CLIP_MERCHANT_ITEM",F.CLICK="CLICK",F.CLIP_ECOM_ITEM="CLIP_ECOM_ITEM",F.ITEM_IMPRESSION="ITEM_IMPRESSION",F.SEE_ALL_DEALS="SEE_ALL_DEALS";var eH=function(e,t){var n={merchantId:t.merchant_id},i=null,o=null,r=null;switch(e){case g.Flyer:i={"com.flipp.beacon.shopperPlatform.entity.FlyerItemData":{flyer:{flyerId:ed(t.flyer_id,0),flyerRunId:-1,flyerTypeId:-1,storeId:null,premium:!!t.premium},flyerItem:{id:ed(t.flyer_item_id,0)}}};break;case g.Merchant:o={"com.flipp.beacon.shopperPlatform.entity.MerchantItemData":{merchantItem:{globalID:t.global_id||"-1",price:{double:t.price||-1}},storeId:t.store_code?ed(t.store_code):-1,url:t.link||""}};break;case g.Ecom:r={"com.flipp.beacon.shopperPlatform.entity.EcomItemData":{ecomItem:{id:t.id?ed(t.id):-1,itemId:t.item_id?{string:t.item_id||""}:t.global_id_int?{string:t.global_id_int||""}:t.global_id?{string:t.global_id||""}:null,sku:t.sku?{string:t.sku||""}:null,globalId:t.global_id_int?{string:t.global_id_int||""}:t.global_id?{string:t.global_id||""}:null},url:t.link||t.url||""}}}return{itemType:e,merchant:n,flyerItemData:i,merchantItemData:o,ecomItemData:r}},eB=function(e){switch(e){case"flyer":return g.Flyer;case"merchant_item":case"merchant":return g.Merchant;case"ecom":return g.Ecom;default:throw Error("ULP item type not recognized")}},ej=function(e){switch(e){case _.CLICK_MEATBALL:return 5229;case _.SHARE_ITEM:case _.CLIP_ITEM:case _.CLIP_MERCHANT_ITEM:case _.CLIP_ECOM_ITEM:return 5230;case _.SEE_ITEM:case _.SEE_MERCHANT_ITEM:case _.CLICK:return 5231;default:throw Error("No schema associated with ULP message")}},eW=function(e,t,n,i,o){return{campaignId:e.campaignId,flightId:e.flightId,advertiserId:e.advertiserId,creativeId:e.creativeId,adId:e.adId,siteId:t,zoneId:n,customUrl:o?{string:o}:null,positionIndex:i?{int:i}:null}},eV=function(e){var t=e.partnerNameIdentifier,n=e.elapsedSeconds,i=e.decision,o=e.siteId,r=e.zoneId,s=e.customUrl,a=e.options,l=e.postalCode,d=e.campaignNameIdentifier,c=e.positionIndex;return j(j({},eb({schemaId:5226,partnerNameIdentifier:t,siteId:o,zoneId:r,options:a,postalCode:l,campaignNameIdentifier:d,shopperPlatformUx:p.UlpInline})),{elapsedSeconds:n,decision:eI(eW(i,o,r,c,s))})},eG=function(e){var t=e.partnerNameIdentifier,n=e.decision,i=e.siteId,o=e.zoneId,r=e.customUrl,s=e.options,a=e.postalCode,l=e.campaignNameIdentifier,d=e.positionIndex;return j(j({},eb({schemaId:5227,partnerNameIdentifier:t,siteId:i,zoneId:o,options:s,postalCode:a,campaignNameIdentifier:l,shopperPlatformUx:p.UlpInline})),{decision:eI(eW(n,i,o,d,r))})},eK=function(e){var t=e.partnerNameIdentifier,n=e.decision,i=e.siteId,o=e.zoneId,r=e.customUrl,s=e.options,a=e.postalCode,l=e.campaignNameIdentifier,d=e.positionIndex;return j(j({},eb({schemaId:5228,partnerNameIdentifier:t,siteId:i,zoneId:o,options:s,postalCode:a,campaignNameIdentifier:l,shopperPlatformUx:p.UlpInline})),{decision:eI(eW(n,i,o,d,r))})},eY=function(e){var t=e.partnerNameIdentifier,n=e.decision,i=e.siteId,o=e.zoneId,r=e.customUrl,s=e.message,a=e.itemType,l=e.options,d=e.postalCode,c=e.campaignNameIdentifier,u=e.positionIndex;return j(j({},eb({schemaId:ej(s.type),partnerNameIdentifier:t,siteId:i,zoneId:o,options:l,postalCode:d,campaignNameIdentifier:c,shopperPlatformUx:p.UlpInline})),{itemData:eH(a,s.detail),decision:eI(eW(n,i,o,u,r))})},e$=function(e){var t=e.partnerNameIdentifier,n=e.decision,i=e.siteId,o=e.zoneId,r=e.customUrl,s=e.options,a=e.postalCode,l=e.campaignNameIdentifier,d=e.positionIndex;return j(j({},eb({schemaId:5232,partnerNameIdentifier:t,siteId:i,zoneId:o,options:s,postalCode:a,campaignNameIdentifier:l,shopperPlatformUx:p.UlpInline})),{decision:eI(eW(n,i,o,d,r))})},eJ=function(e){var t=e.partnerNameIdentifier,n=e.decision,i=e.siteId,o=e.zoneId,r=e.customUrl,s=e.message,a=e.options,l=e.postalCode,d=e.campaignNameIdentifier,c=e.positionIndex;return j(j({},eb({schemaId:5233,partnerNameIdentifier:t,siteId:i,zoneId:o,options:a,postalCode:l,campaignNameIdentifier:d,shopperPlatformUx:p.UlpInline})),{itemData:s.detail.items.map(function(e){return eH(eB(e.itemType),e)}),decision:eI(eW(n,i,o,c,r))})},eX=function(e){var t=e.partnerNameIdentifier,n=e.decision,i=e.siteId,o=e.zoneId,r=e.customUrl,s=e.options,a=e.postalCode,l=e.campaignNameIdentifier,d=e.errorMessage,c=e.positionIndex;return j(j({},eb({schemaId:5209,partnerNameIdentifier:t,siteId:i,zoneId:o,options:s,postalCode:a,campaignNameIdentifier:l,shopperPlatformUx:p.UlpInline})),{decision:eI(eW(n,i,o,c,r)),errorMessage:d})},eQ=function(e){var t=e.partnerNameIdentifier,n=e.decision,i=e.siteId,o=e.zoneId,r=e.customUrl,s=e.options,a=e.postalCode,l=e.campaignNameIdentifier,d=e.positionIndex;return j(j({},eb({schemaId:5234,partnerNameIdentifier:t,siteId:i,zoneId:o,options:s,postalCode:a,campaignNameIdentifier:l,shopperPlatformUx:p.UlpInline})),{decision:eI(eW(n,i,o,d,r))})},eZ=function(){var e=new URLSearchParams(window.location.search).get("flipp-content-code");return navigator.webdriver&&!e},e0=function(){return"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype};function e1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){var i;i=n[t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i})}return e}function e2(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n.push.apply(n,i)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let e5=function(e,t,{leading:n=!0,trailing:i=!1}={}){let o=!1,r=!1,s=[];return function(...a){r=!0,s=a,o||(o=!0,n&&(r=!1,e(...s)),setTimeout(()=>{i&&r&&e(...s),o=!1,r=!1},t))}},e3=function(e,t){let n=e5(()=>(e6(e.getBoundingClientRect())&&(t(),window.removeEventListener("scroll",n)),null),66);return n},e4=function(e,t,n=null,i=2){if(e0()){let o={rootMargin:`${100*i}% 0px`,root:n?document.querySelector(n):null},r=new IntersectionObserver(e=>{e.some(e=>e.isIntersecting)&&(t(),r.disconnect())},o);r.observe(e)}else{if(e6(e.getBoundingClientRect())){t();return}window.addEventListener("scroll",e3(e,t),{passive:!0})}},e6=function(e,t=2){return e.top>=0?e.top-window.innerHeight<window.innerHeight*t:Math.abs(e.bottom)<window.innerHeight*t};var e7=["lettuce","spinach","broccoli","carrot","cauliflower","peas","tomato","cucumber","bell pepper","onion","garlic","eggplant","zucchini","brussels sprouts","kale","mushrooms","radish","asparagus","beets","green beans","celery","cabbage","leek","turnip","parsnip","squash","artichoke","sweet potato","swiss chard","chili","okra","collard greens","pumpkin","avocado","russet potatoes","red onion","white onion","chicken breast","chicken breasts","chicken thigh","chicken wing","chicken drumstick","chicken liver","whole chicken","ground beef","beef steak","beef brisket","beef shank","beef rib","beef tenderloin","beef chuck","beef loin","pork loin","pork chop","pork belly","pork rib","pork shoulder","pork leg","ground pork","turkey breast","ground turkey","turkey leg","turkey wing","whole turkey","duck breast","duck leg","whole duck","chicken","beef","pork","lamb","turkey","duck","venison","rabbit","bacon","ham","bison","goose","liver","quail","pheasant","corned beef","ribs","steak","veal","mutton","lamb chop","lamb leg","lamb shank","lamb rib","rabbit loin","venison steak","bison steak","milk","cheese","butter","yogurt","eggs","whey","curd","cream cheese","almond milk","cheddar","brie","feta","gouda","mozzarella","parmesan","swiss cheese","blue cheese","cottage cheese","sour cream","whole milk","skim milk","semi-skimmed milk","2% milk","heavy cream","whipping cream","light cream","sour cream","double cream","clotted cream","unsalted butter","salted butter","cultured butter","ghee","fresh cheese","aged cheese","soft cheese","hard cheese","blue cheese","cheddar cheese","mozzarella cheese","parmesan cheese","feta cheese","goat cheese","ricotta cheese","camembert cheese","brie cheese","cream cheese","cottage cheese","plain yogurt","greek yogurt","low-fat yogurt","full-fat yogurt","yogurt drink","egg white","egg yolk","quail egg","duck egg","egg","eggs","popcorn","whey protein","casein","lactose-free milk","condensed milk","evaporated milk","milk powder","salmon","tuna","shrimp","lobster","crab","mussels","oysters","trout","squid","octopus","cod","halibut","herring","mackerel","sardines","sea bass","tilapia","scallops","clams","catfish","wild salmon","farmed salmon","atlantic salmon","pacific salmon","smoked salmon","salmon fillet","salmon steak","tuna steak","tuna sashimi","yellowfin tuna","bluefin tuna","albacore tuna","canned tuna","king shrimp","tiger shrimp","white shrimp","pink shrimp","dried shrimp","shrimp paste","blue crab","king crab","soft shell crab","snow crab","crab meat","crab claw","blue mussel","green mussel","pacific oyster","rock oyster","giant oyster","rainbow trout","brown trout","sea trout","squid ink","squid tentacles","baby octopus","octopus tentacles","cod fillet","black cod","cod liver","halibut steak","halibut fillet","fresh herring","pickled herring","spanish mackerel","king mackerel","freshwater sardines","sea sardines","sea bass fillet","tilapia fillet","sea scallop","bay scallop","hard clam","soft clam","surf clam","catfish fillet","grilled catfish","lobster tail","lobster claw","spiny lobster","eel meat","jellyfish","sea urchin","roe","caviar","apple","apples","banana","cherry","date","grape","lemon","orange","peach","pear","strawberry","watermelon","blueberry","pineapple","kiwi","mango","papaya","plum","blackberry","raspberry","tangerine","lime","grapefruit","cranberry","pomegranate","lychee","fig","passion fruit","guava","apricot","goji berry","jackfruit","rice","wheat","quinoa","barley","oats","cornmeal","rye","almonds","peanuts","walnuts","cashews","pistachios","pecans","macadamia","hazelnuts","chestnuts","pine nuts","flaxseed","sesame seeds"];let e9='script[type="application/ld+json"]';function e8(e){return"@graph"in e}function te(){let e=document.querySelectorAll(e9),t=[];if(!e)return t;let n=e=>{"NewsArticle"===e["@type"]&&t.push(...e.keywords||[])};return e.forEach(e=>{try{let t=JSON.parse(e.innerText);e8(t)?t["@graph"].forEach(e=>{n(e)}):Array.isArray(t)?t.forEach(e=>{n(e)}):n(t)}catch(e){}}),t}function tt(){let e;try{e=window.parent.document}catch(e){return console.warn("Will not resize or position if on another domain."),null}if(!e)return null;let t=e.querySelectorAll("iframe");for(let e=0;e<t.length;e++){let n=t[e];try{if(window===n.contentWindow)return n}catch(e){continue}}return null}function tn(e,t,n){var i;if((document.body&&1!==document.body.children.length||"flipp-"!==document.body.children[0].id.substring(0,6))&&!(ti()||t)){console.warn("Will not resize if not only our container present.");return}let o=tt();if(!o)return;let r=0|document.body.offsetHeight,s=(null===(i=document.querySelector(".flippxp-frame"))||void 0===i?void 0:i.getBoundingClientRect().height)||0;o.style.height=`${e+Math.max(0,r-s)}px`,n&&(o.style.width="100%")}function ti(){var e;return!!(null===(e=window.frameElement)||void 0===e?void 0:e.id.startsWith("google_ads_iframe"))&&document.querySelectorAll(".GoogleActiveViewElement, .GoogleActiveViewInnerContainer").length>0}let to=e=>{let t=(e,t)=>(e-t+13)%26+t;return e.replace(/[a-zA-Z]/g,e=>{let n=e.charCodeAt(0);return n>=65&&n<=90?String.fromCharCode(t(n,65)):n>=97&&n<=122?String.fromCharCode(t(n,97)):e})},tr=(e,t)=>t.filter(t=>e.toLowerCase().includes(t.toLowerCase())),ts=(e,t)=>to(t.join(",")).split(",").filter(t=>e.toLowerCase().includes(t.toLowerCase())),ta=e=>Array.from(e).filter(e=>null!==e).map(e=>{var t;return(null==e?void 0:null===(t=e.textContent)||void 0===t?void 0:t.trim())||""}),tl=(e,t)=>{let n=window.location.href,i=document.title.trim(),o=ta(document.querySelectorAll("p")),r=ta(document.querySelectorAll("a")),s=`${n} ${i} ${o.join(" ")} ${r.join(" ")}`;return t?ts(s,e):tr(s,e)},td=["4puna","8puna","nobegvba","npg bs rivy","npg bs\xa0frqvgvba","npgvir fubbgre","npgvir fubbgref","nqnz gbyrqb","nqnz lnuvlr tnqnua","nqbys uvgyre","nqhyg pnz","nqhyg pnzf","nqhyg svyz","nqhyg ivqrbf","nqhyg jropnz","nqhyg jrofvgrf","nuzrq tunvynav","nuzrq tbqnar","nuzrq voenuvz ny zhtunffvy","nuzrq zbunzzrq unzrq nyv","nubyr","nve fgevxr","nx 47","nx-15","nx-47","nx47","nxeba","ny dnrqn","ny dhrqn","ny funonno","ny funz","ny hzne zhwnuvqrra","ny-snqy","ny-uneo","ny-xubone","ny-zvqune","ny-ahfen sebag","ny-dnrqn","ny-funonno","ny-mnjnuvev","nyntnfpb","nypbubyvfz","nyrccb","nyrk wbarf","nyv noh zhxunzznq","nyv ngjn","nyv fnrq ova nyv ry ubbevr","nyvrkcerff","nyy yvirf znggre","nyynu","nyyrtngvbaf","nyygry","nyz","nydnrqn","nydhena","nyg evtug","nzore arny","nzzba ohaql","nany","nany ornqf","nany frk","narzvn","natre znantrzrag","navzny pehrygl","navzny frk","naberkvn","naberkvp","nagv vfynz","nagv-inp","nagv-inppvar","nagv-ink","nagvsn","nahf","najne ny njynxv","najne ny-njynxv","ne-15 evsyr","nesvq","nezrq fgnaqbss","nfze rngf","nfcretre’f","nfcretref","nffnffvangvba","nffnhyg","nffnhyg evsyr","nffnhyg evsyr ona","ngynagn znffnper","ngbzvp obzo","nggnpx","nggnpx va ybjre znaunggna","nggnpx ba cnevf","nhfpujvgm","nhgb nppvqrag","njynxv","nlzna ny-mnjnuvev","o12","onpgrevn","onq obff","onqnff","ontuqnq","onyyvfgvp zvffvyrf","oneronpx","oneryl yrtny","onfune ny-nffnq","onfuve nffnq","onggyrsvryq","ornfgvnyvgl","orurnqvat","ora pehzc","orfgvnyvgl","ovyny unqsv","ova ynqra","ovatr rngvat","obqlpnz","obzo","obzovat","obbfgre","oehgnyvgl","ohxxnxr","ohyvzvn","ohetynel","pnepvabtra","pyhfgreshpx","pbpxfhpxre","pbagnzvangrq","pbeban","pbeban ivehf","pbebanivehf","pbivq","pbivq 19","pbivq-19","pebff-pbagnzvangvba","phesrj","qnvyl fgbezre","qrshaq gur cbyvpr","r.pbyv","snttvg","snttbg","svernez","sybbq","sbbq nqqvpgvbaf","sernx","sernx bhg","tnmn","tha","tha evtugf","unznf","unenffzrag","ubybpnhfg","ubeevsvp nggnpx","v pna'g oerngur","vafheerpgvba","vfenry","xvyy","xvyyrq","xvyyf","xxx","xbeban","xh xyhk xyna","ynjfhvg","ynlbssf","yvfgrevn","yvirfrk","ybpxqbja","ybbgvat","znavsrfgnag","znavsrfgngvba","znavsrfgngvbaf","znff fubbgvat","zvffvyr","zbyrfg","zbyrfgrq","zhxonat","zheqre","zheqrere","zhgvyngvba","anxrq","anmv","arb anmv","avtnobb","avttn","avttre","avttref","avgtyrg","aen","ahqr","bofprar","bvy fcvyy","bhgoernx","cnyrfgvavna","cnaqrzvp","crqbcuvyr","crrq","crccre fcenl","crfgvpvqr","cvpn qvfbeqre","cbvfbavat","cbyyhgvba","cbea","cerpvapg ohearq","cebhq oblf","ertvf xbepuvafxv-cndhrg","evsyr","evbg","evbgre","evbgf","evc","ehoore ohyyrgf","fnyzbaryyn","fnaqavttre","fngna","fryravhz","frk","frkhny zvfpbaqhpg","fuvg","fvpxrarq","fxvaurnq","fghqragf xvyyrq","fhrq","fhvpvqny","fhvpvqr","fhcerznpvfg","fhcerzr pbheg","grne tnf","grnetnf","greebevfz","gursg","gehzc","gehzc ergnyvngvba","gjvggre gehzc ivbyrapr","ha inkkrq","ha-inppvangrq","haerfg fubbgvat","hcevfvat","inppvar znaqngr","ink znaqngr","ivehf","jrncbaf","juvgr fhcerznpvfg"],tc=e=>e<=18e3?e+2e3:e<=25e3?e+5e3:e+1e4,tp=e=>t=>{var n;return t.intersectionRect.height>e*((null===(n=t.rootBounds)||void 0===n?void 0:n.height)||window.innerHeight)},tu=!1,th=()=>tu,tm=(e,t,n,i=.5,o=tc)=>{let r=0,s=0,a=2e3,l=n||8e3,d=!1,c=!1,p=!1,u=0,h=null,m=tp(i),f=()=>{let t=Date.now();!tu&&r>=l&&(tu=!0,e.dispatchEvent(new Event("flipp-engagement"))),document.hasFocus()&&!document.hidden&&a<=6e4&&(r+=t-s,e.dispatchEvent(new CustomEvent("flipp-heartbeat",{detail:{time:a}})),a=o(a)),s=t,a<=6e4&&(u=window.setTimeout(f,a-r))},g=()=>{d=!1;let e=Date.now()-s;r+=e,s=0,clearTimeout(u)},v=()=>{d=!0,s=Date.now(),u=window.setTimeout(f,a-r),p||(p=!0,e.dispatchEvent(new Event("flipp-open")))},y=e5(()=>{let t=e.getBoundingClientRect(),n=!(t.top>window.innerHeight||t.bottom<0),i=.5*window.innerHeight,o=t.top<i&&t.bottom>i;return!c&&n&&(c=!0,e.dispatchEvent(new Event("flipp-view"))),!d&&o?v():d&&!o&&g(),null},66);if(t){let t=Math.min(1,Math.max(.001,window.innerHeight/2/e.clientHeight));(h=new IntersectionObserver(t=>{!c&&t.some(e=>e.isIntersecting)&&(c=!0,e.dispatchEvent(new Event("flipp-view"))),!d&&t.some(m)?v():d&&t.every(e=>!m(e))&&g()},{threshold:[0,.9*t,t,1.1*t,1],rootMargin:"0px 1000px 0px 1000px",root:null})).observe(e)}else window.addEventListener("scroll",y);return()=>(window.clearTimeout(u),h&&h.disconnect(),window.removeEventListener("scroll",y),r+Date.now()-s)};function tf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){tf(e,t,n[t])})}return e}function tv(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n.push.apply(n,i)}return n})(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}),e}let ty=["Cannot read properties of undefined (reading 'map')","Failed to fetch","Cannot read properties of undefined (reading 'length')","undefined is not an object (evaluating 'de.ecom_items.map')","undefined is not an object (evaluating 'de.ecom_items.length')","Load failed","No items are rendered in the ULP"];class tI{get preview(){return this._preview}get expandCount(){return this._expandCount}get contentElement(){return this._contentElement}get hoverExpandable(){return this._hoverExpandable}sendMessage(e,t){var n;if(!this.iframe)return null;null===(n=this.iframe.contentWindow)||void 0===n||n.postMessage({type:e,data:t},"*")}sendCountdownState(e,t){return this.sendMessage(C.COUNTDOWN_STATE,{countdownEnd:e,countdownInterval:t}),null}getDynamicHeaderConfig(){var e,t;let n=null===(e=this.kevelMetadata)||void 0===e?void 0:e.dynamicHeader,i=function(){var e;let t=Array.from(document.querySelectorAll(e9)).map(e=>{let t=e.textContent||"";try{return JSON.parse(t)}catch(e){return null}}).filter(Boolean).flatMap(e=>e&&e8(e)?e["@graph"]:e).find(e=>{let t=Array.isArray(null==e?void 0:e["@type"])?null==e?void 0:e["@type"]:[null==e?void 0:e["@type"]];return null==t?void 0:t.includes("Recipe")}),n=RegExp("\\b(?:teaspoon|tsp|tablespoon|tbsp|fluid ounce|fl oz|gill|cup|pint|pt|quart|qt|gallon|gal|milliliter|ml|centiliter|cl|deciliter|dl|liter|l|ounce|oz|pound|lb|milligram|mg|gram|grams|g|kilogram|kg|pinch|dash|touch|smidgen|drop|handful|stick|slice|piece|whole|half|quarter|third|eighth|sixteenth|bundle|bunch|sprig|leaf|head|clove|bulb|stalk|wedge|cube|fillet|strip|sheet|round|scoop|jar|bottle|can|package|bag|box|container|roll|tube|tray|bar|square|segment|kernels|packet|envelope|spoonful|serving)s?\\b","gi"),i=null==t?void 0:null===(e=t.recipeIngredient)||void 0===e?void 0:e.map(e=>e.replace(/,\s?.*/,"").replace(n,"").replace(/^\d+\s*/,"").split(/[\d+/?\d*\s+(),]+/).map(e=>e.replace(/[^a-zA-Z]/g,"").toLowerCase()).filter(e=>e.length>2&&!e.endsWith("ed")).join(" "));return t?{cleanedIngredients:i,recipeName:t.headline||t.name}:null}();return tv(tg({},n),{itemsForSearch:[...function(e){let t,n;let i=(t=[],n=e,Array.from(e7).sort((e,t)=>t.split(" ").length-e.split(" ").length).forEach(e=>{let i=RegExp(`\\b${e}\\b`,"gi"),o=n.match(i);o&&o.length>0&&(t=[...t,...Array(o.length).fill(e)],n=n.replace(i,""))}),t).reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{}),o=[],r=Object.entries(i).sort((e,t)=>t[1]-e[1]);if(r.length)for(let[e,t]of r)t>=4&&o.push(e);return o}(document.body.innerText),...null!==(t=null==i?void 0:i.cleanedIngredients)&&void 0!==t?t:[],...eR()],recipeName:null==i?void 0:i.recipeName})}requestExpand(){return this.sendMessage(C.REQUEST_EXPAND,!0),null}handleSendEv(e){window.flippxp.evTag[e.compositeKey]?this.sendMessage(C.SEND_EV,!1):(window.flippxp.evTag[e.compositeKey]=!0,this.sendMessage(C.SEND_EV,!0))}composeAppConfig(){var e,t,n,i,o,r,s,a,l,d,c,p,u,h,m,f,g,v,y,w,E,x,C,k,S,M,T;if(!this.kevelMetadata)return null;let N=navigator.languages?navigator.languages[0]:navigator.language,P=JSON.stringify({decisions:{inline:[this.data]},location:this.geoData}),_=new URL(window.location.toString()),A=_.searchParams.get("sessionId"),O=_.searchParams.get("itemId"),R=_.searchParams.get("flipp-test-keywords");return{campaignNameIdentifier:this.kevelMetadata.campaignNameIdentifier,ux:this.options.standalone?I.DEFAULT:I.INLINE,adView:this.options.isGoogleAmp?b.SafeFrame:b.Native,intersectionObserver:this.intersectionObserver,siteId:this.siteId,site:(T=this.options.overrideHostname)?T:window.location.hostname?window.location.hostname:window.parent.location.hostname?window.parent.location.hostname:"none",locale:(null!==(w=null===(e=this.sdk)||void 0===e?void 0:e.locale)&&void 0!==w?w:N).substring(0,2),country:null===(t=this.geoData)||void 0===t?void 0:t.country,partnerNameIdentifier:this.publisherNameIdentifier,campaignConfigUrl:this.kevelMetadata.campaignConfigUrl,ulpUrl:this.kevelMetadata.ulpUrl,survey:this.kevelMetadata.survey,tags:tv(tg({},null===(o=this.data)||void 0===o?void 0:null===(i=o.storefront)||void 0===i?void 0:null===(n=i.campaignConfig)||void 0===n?void 0:n.tags),{campaignManagement:{open:this.impressionUrl,engagement:this.engagementUrl,impression:this.liveRampTag}}),urlKeyword:R,expandOnReadMore:!!this.options.dwellExpandable||!!this.options.expandOnReadMore,preventItemModalClose:this.kevelMetadata.preventItemModalClose,creativeEvTimerMs:this.kevelMetadata.evTimerMs,hideHeader:this.kevelMetadata.hideHeader,themeColorBg:this.kevelMetadata.themeColorBg,themeColorFg:this.kevelMetadata.themeColorFg,sessionId:null!=A?A:eu,uid:null!==(E=null===(r=this.sdk)||void 0===r?void 0:r.userId)&&void 0!==E?E:ei(this.options),startCompact:void 0===this.options.startCompact?null===(s=this.kevelMetadata)||void 0===s?void 0:s.startCompact:!!this.options.startCompact,decision:eW(this.data,this.siteId,this.zoneIds[0]||-1,this.positionIndex,this.getCustomUrl()),integrationType:ec(this.options),platform:ef(),userPostalCode:null===(a=this.geoData)||void 0===a?void 0:a.postal_code,latitude:null===(l=this.geoData)||void 0===l?void 0:l.latitude,longitude:null===(d=this.geoData)||void 0===d?void 0:d.longitude,regionCode:null===(c=this.geoData)||void 0===c?void 0:c.region,regionName:null===(p=this.geoData)||void 0===p?void 0:p.region_name,sdk:this.sdk,storefrontConfig:null===(u=this.data)||void 0===u?void 0:u.storefront,noPopOnLink:!!this.kevelMetadata.noPopOnLink,showLocation:!!this.kevelMetadata.showLocation,dynamicHeader:this.getDynamicHeaderConfig(),dynamicHeaderIframeUrl:this.kevelMetadata.dynamicHeaderIframeUrl,dynamicPopupIframeUrl:this.kevelMetadata.dynamicPopupIframeUrl,dynamicHeaderIframeHeight:this.kevelMetadata.dynamicHeaderIframeHeight,dynamicPopupIframeHeight:this.kevelMetadata.dynamicPopupIframeHeight,highlightedFlyerItemIds:null!==(x=this.kevelMetadata.highlightedFlyerItemIds)&&void 0!==x?x:[],highlightedFlyerItemsOptions:this.kevelMetadata.highlightedFlyerItemsOptions,targetedOverlayImageUrl:null!==(C=this.kevelMetadata.targetedOverlayImageUrl)&&void 0!==C?C:null,fallbackImageUrl:null===(f=this.data)||void 0===f?void 0:null===(m=f.storefront)||void 0===m?void 0:null===(h=m.campaignConfig)||void 0===h?void 0:h.fallbackImageUrl,fallbackLinkUrl:null===(y=this.data)||void 0===y?void 0:null===(v=y.storefront)||void 0===v?void 0:null===(g=v.campaignConfig)||void 0===g?void 0:g.fallbackLinkUrl,dwellTimerMs:this.kevelMetadata.dwellTimerMs,hoverExpandable:this._hoverExpandable,isVimpCallbackSet:!!window.flippxp.vimpTrackerFunc,stepHeight:null!==(S=null!==(k=this.kevelMetadata.stepHeight)&&void 0!==k?k:this.options.stepHeight)&&void 0!==S?S:1500,campaigns:P,itemId:O,keywords:this.keywords,nearestStores:this.data.nearestStores,hideTTMButton:this.kevelMetadata.hideTTMButton,hideShareButton:this.kevelMetadata.hideShareButton,debugMode:window.flippxp.debugMode,hostedUrl:null!==(M=this.kevelMetadata.hostedUrl)&&void 0!==M?M:null,isMRAID:this.options.isMRAID,mediaPartnerDescriptiveValueTag:this.options.mediaPartnerDescriptiveValueTag,isNativeGAMWebview:this.options.isNativeGAMWebview,wideCompact:this.options.wideCompact,wideCompactBackgroundColor:this.options.wideCompactBackgroundColor,enableOptimizedShimmer:this.options.enableOptimizedShimmer}}handleInlineGeometry(){if(!this.containerElement||!this.containerWindow||!this.contentElement)return null;let t=e(this.containerElement,this.contentElement,this.containerWindow);null!=t&&this.sendMessage(C.INLINE_GEOMETRY,t)}handleEndPreview(){if(!this.iframe)return null;this._preview=!1,this.sendMessage(C.END_PREVIEW,!0),this.handlePreviewEnded(this)}handleCallback(e){if("viewableImpression"===e&&window.flippxp.vimpTrackerFunc)return window.flippxp.vimpTrackerFunc()}getHeight(){var e,t;return null!==(t=null===(e=this.iframe)||void 0===e?void 0:e.offsetHeight)&&void 0!==t?t:0}getAdType(){var e,t;return(null===(e=this.kevelMetadata)||void 0===e?void 0:e.survey)?I.SURVEY:(null===(t=this.kevelMetadata)||void 0===t?void 0:t.ulpUrl)?I.ULP:I.INLINE}handleIframeHeightResize(e){if(!this.iframe)return null;let t=Math.ceil(e.height);this.iframe.offsetHeight<t&&(this._expandCount++,1===this.expandCount&&(this.hasScrolledBeyond=!1)),this.iframe.style.height=`${t}px`,this.resizeCallback(this,t+8)}handleUlpSeeAllDealsClick(){var e,t;J.enqueue(eQ({partnerNameIdentifier:this.publisherNameIdentifier,decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),options:this.options,postalCode:null===(e=this.geoData)||void 0===e?void 0:e.postal_code,campaignNameIdentifier:null===(t=this.kevelMetadata)||void 0===t?void 0:t.campaignNameIdentifier,positionIndex:this.positionIndex}))}handleUlpClick(e,t){var n,i;return J.enqueue(eY({partnerNameIdentifier:this.publisherNameIdentifier,decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),message:t,itemType:e,options:this.options,postalCode:null===(n=this.geoData)||void 0===n?void 0:n.postal_code,campaignNameIdentifier:null===(i=this.kevelMetadata)||void 0===i?void 0:i.campaignNameIdentifier,positionIndex:this.positionIndex})),null}handleUlpItemImpressions(e){var t,n;return J.enqueue(eJ({partnerNameIdentifier:this.publisherNameIdentifier,decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),message:e,options:this.options,postalCode:null===(t=this.geoData)||void 0===t?void 0:t.postal_code,campaignNameIdentifier:null===(n=this.kevelMetadata)||void 0===n?void 0:n.campaignNameIdentifier,positionIndex:this.positionIndex})),null}handleUlpErrorMessage(e){var t,n;return J.enqueue(eX({errorMessage:e,partnerNameIdentifier:this.publisherNameIdentifier,decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),options:this.options,postalCode:null===(t=this.geoData)||void 0===t?void 0:t.postal_code,campaignNameIdentifier:null===(n=this.kevelMetadata)||void 0===n?void 0:n.campaignNameIdentifier,positionIndex:this.positionIndex})),null}getCustomUrl(){var e,t,n,i;return null!==(i=null!==(n=null===(e=this.kevelMetadata)||void 0===e?void 0:e.ulpUrl)&&void 0!==n?n:null===(t=this.kevelMetadata)||void 0===t?void 0:t.campaignConfigUrl)&&void 0!==i?i:"no-url"}registerScroll(){if(!this.containerWindow||this.options.isGoogleAmp)return null;this.containerWindow.addEventListener("scroll",e5(()=>{if(!this.containerWindow||!this.containerElement||!this.contentElement)return null;let t=e(this.containerElement,this.contentElement,this.containerWindow);return null!==t&&this.sendMessage(C.INLINE_GEOMETRY,t),null},66,{leading:!1,trailing:!0}))}registerTags(){var e,t;let n={open:[this.impressionUrl],engagement:[this.engagementUrl],impression:[]};return this.liveRampTag=eT.buildLiveRampTag(this.data,this.geoData),this.liveRampTag&&(null===(t=n.impression)||void 0===t||t.push(this.liveRampTag)),eT.addTags({campaignManagement:n},{startCompact:(null===(e=this.options)||void 0===e?void 0:e.startCompact)||!1}),null}initGoogleAmp(e,t){return window.parent.postMessage({sentinel:"amp",type:"send-intersections"},"*"),window.parent.postMessage({sentinel:"amp",type:"embed-size",width:e,height:t},"*"),window.addEventListener("message",e=>{if(!(e.source===window.parent&&e.origin!==window.location.origin&&e.data&&"amp"===e.data.sentinel&&"intersection"===e.data.type))return null;e.data.changes.forEach(e=>{if(e.boundingClientRect.height<250)return this.sendMessage(C.INLINE_GEOMETRY,{yiv:0,h:0}),null;let t={self:{yiv:e.intersectionRatio,h:e.boundingClientRect.height}};this.sendMessage(C.INLINE_GEOMETRY,t)})}),null}handleNoExperienceServed(){return this.resizeCallback(this,0),null}assignData(){var e,t,n;return this.creativeWidth=this.data.width,this.creativeHeight=this.data.height,this.engagementUrl=this.data.clickUrl,this.impressionUrl=this.data.impressionUrl,this._hoverExpandable=(null===(e=ef())||void 0===e?void 0:e["com.flipp.beacon.shopperPlatform.enumeration.Platform"])==="Desktop"&&(!!this.options.startCompact||null!==(t=this.kevelMetadata)&&void 0!==t&&!!t.startCompact)&&!!(null===(n=this.kevelMetadata)||void 0===n?void 0:n.hoverExpandable),null}checkWideCompact(){var e;let t=el.getDeviceInfo();return!!this.options.startCompact&&!!this.options.wideCompact&&!!this.options.wideCompactBackgroundColor&&(e=this.options.wideCompactBackgroundColor,/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e))&&"desktop"===t.type}calculateTargetDimensions(e){var t,n,i,o,r,s,a,l;let d=this.checkWideCompact(),c=this.creativeWidth&&this.creativeHeight?this.creativeHeight/this.creativeWidth:6,p=d?Math.max(e.offsetWidth,300):Math.max(Math.min(e.offsetWidth,1024),300),u=Math.min(window.screen.height-150,600),h=null!==(r=null!==(o=null===(t=this.kevelMetadata)||void 0===t?void 0:t.compactHeight)&&void 0!==o?o:this.options.compactHeight)&&void 0!==r?r:u,m=null!==(a=null!==(s=null===(n=this.kevelMetadata)||void 0===n?void 0:n.standardHeight)&&void 0!==s?s:this.options.standardHeight)&&void 0!==a?a:2400,f=Math.min(this.options.preview?200:p*c,this.options.startCompact||(null===(i=this.kevelMetadata)||void 0===i?void 0:i.startCompact)?h:m);return{targetWidth:p,targetHeight:d?600:null!==(l=this.options.safeFrameHeight)&&void 0!==l?l:f}}isULPorSurveyPreview(){var e,t;return this._preview&&(null===(e=this.kevelMetadata)||void 0===e?void 0:e.ulpUrl)||this._preview&&(null===(t=this.kevelMetadata)||void 0===t?void 0:t.survey)}initializeIframe(e,t,n){let i=document.createElement("iframe");i.className="flippxp-frame",i.style.height=`${t}px`,i.style.background="#fff",i.style.width=this.sdk||this.options.nestedIframeFullBleed?"100%":`${e}px`;let o="flipp-"+btoa(encodeURIComponent(JSON.stringify(this.composeAppConfig())));i.setAttribute("scrolling","no"),i.setAttribute("frameborder","no"),i.setAttribute("allow","web-share"),i.setAttribute("name",o);let r="https://shopper.flipp.com/static/1.47.0/latest";if(n){var s,a;r=n,(null===(s=this.geoData)||void 0===s?void 0:s.postal_code)&&(r=`${r}&postal_code=${null===(a=this.geoData)||void 0===a?void 0:a.postal_code}`)}else this.checkWideCompact()?i.style.maxWidth="100%":this.options.startCompact?i.style.maxWidth="650px":i.style.maxWidth=this.sdk||this.options.standalone?"1024px":"800px",i.style.margin="0 auto",i.style.display="block";let l=new URL(r);return this.preview&&l.searchParams.append("preview","true"),i.setAttribute("src",l.toString()),i}registerUlpMessageListeners(e){window.addEventListener("message",e=>(this.handlePostMessages(e),null)),e.addEventListener("flipp-view",()=>{var e,t;return J.enqueue(eG({partnerNameIdentifier:this.publisherNameIdentifier,decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),options:this.options,postalCode:null===(e=this.geoData)||void 0===e?void 0:e.postal_code,campaignNameIdentifier:null===(t=this.kevelMetadata)||void 0===t?void 0:t.campaignNameIdentifier,positionIndex:this.positionIndex})),null}),e.addEventListener("flipp-open",()=>{var e,t;return J.enqueue(eK({partnerNameIdentifier:this.publisherNameIdentifier,decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),options:this.options,postalCode:null===(e=this.geoData)||void 0===e?void 0:e.postal_code,campaignNameIdentifier:null===(t=this.kevelMetadata)||void 0===t?void 0:t.campaignNameIdentifier,positionIndex:this.positionIndex})),eT.sendOpen(),"function"==typeof window.flippxp.vimpTrackerFunc&&window.flippxp.vimpTrackerFunc(),null},{once:!0}),e.addEventListener("flipp-heartbeat",e=>{var t,n;let i=e.detail.time;return J.enqueue(eV({partnerNameIdentifier:this.publisherNameIdentifier,elapsedSeconds:Math.round(i/1e3),decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),options:this.options,postalCode:null===(t=this.geoData)||void 0===t?void 0:t.postal_code,campaignNameIdentifier:null===(n=this.kevelMetadata)||void 0===n?void 0:n.campaignNameIdentifier,positionIndex:this.positionIndex})),null}),e.addEventListener("flipp-engagement",()=>{var e,t;return J.enqueue(e$({partnerNameIdentifier:this.publisherNameIdentifier,decision:tg({},this.data),siteId:this.siteId,zoneId:this.zoneIds[0]||0,customUrl:this.getCustomUrl(),options:this.options,postalCode:null===(e=this.geoData)||void 0===e?void 0:e.postal_code,campaignNameIdentifier:null===(t=this.kevelMetadata)||void 0===t?void 0:t.campaignNameIdentifier,positionIndex:this.positionIndex})),eT.sendEngagement(),null},{once:!0})}handleSdkOnload(){var e,t;if(null===(e=this.sdk)||void 0===e?void 0:e.platform)return(null===(t=this.data)||void 0===t?void 0:t.height)?ez(this.getAdType(),this.data.height,this.sdk.platform):eL(this.sdk.platform),null}initMraidFunctions(){window.flippxp.mraidHandleExposureChange=(e,t,n)=>{eF({detail:{top:t.y,height:t.height}});let i={x:t.x,y:t.y,top:t.y,width:t.width,height:t.height};this.sendMessage(C.INLINE_GEOMETRY,i)}}render(){if(null==this.data||null==this.data.contents||0===this.data.contents.length)return this.handleNoExperienceServed(),null;this.kevelMetadata=this.data.contents[0].data.customData,this.assignData(),this.registerTags();let e=this.targetEl,t=e.querySelector(".flipp-ux-header");t&&!this.kevelMetadata.hideHeader&&(t.style.display="block");let{targetWidth:n,targetHeight:i}=this.calculateTargetDimensions(e);if(this.options.isGoogleAmp&&this.initGoogleAmp(n,i),this.options.isMRAID&&this.initMraidFunctions(),!this.isULPorSurveyPreview()){if(this.iframe=this.initializeIframe(n,i,this.kevelMetadata.ulpUrl),this._contentElement=this.iframe,e.appendChild(this.iframe),this.containerWindow=window,this.containerElement=e,this.options.nestedIframe){var o,r;let n=null!==(o=null==t?void 0:t.offsetHeight)&&void 0!==o?o:0,i=this._preview?200:document.body.offsetHeight+n+8;this.resizeCallback(this,i),this.containerWindow=window.parent,this.containerElement=null!==(r=tt())&&void 0!==r?r:e}this.intersectionObserver||(console.log("Register Event Listeners"),this.registerScroll()),this.registerUlpMessageListeners(this.iframe),this.kevelMetadata.ulpUrl&&tm(this.iframe,this.intersectionObserver,this.kevelMetadata.evTimerMs),this.sdk&&(this.iframe.onload=()=>this.handleSdkOnload())}}constructor({targetEl:e,publisherNameIdentifier:t,data:n,options:i,resizeCallback:o,siteId:r,zoneIds:s,handlePreviewEnded:a,geoData:l,keywords:d,positionIndex:c}){var p,u;tf(this,"targetEl",void 0),tf(this,"publisherNameIdentifier",void 0),tf(this,"data",void 0),tf(this,"options",void 0),tf(this,"keywords",void 0),tf(this,"resizeCallback",void 0),tf(this,"handlePreviewEnded",void 0),tf(this,"containerWindow",void 0),tf(this,"containerElement",void 0),tf(this,"_contentElement",void 0),tf(this,"iframe",void 0),tf(this,"kevelMetadata",void 0),tf(this,"creativeHeight",void 0),tf(this,"creativeWidth",void 0),tf(this,"engagementUrl",void 0),tf(this,"impressionUrl",void 0),tf(this,"liveRampTag",void 0),tf(this,"siteId",void 0),tf(this,"zoneIds",void 0),tf(this,"sdk",void 0),tf(this,"geoData",void 0),tf(this,"positionIndex",void 0),tf(this,"insideNativeMobileApp",void 0),tf(this,"hasScrolledBeyond",!1),tf(this,"intersectionObserver",void 0),tf(this,"_preview",!1),tf(this,"_expandCount",0),tf(this,"_hoverExpandable",!1),tf(this,"handlePostMessages",e=>{if(!this.iframe||e.source!==this.iframe.contentWindow)return null;let t=e.data,n=t.type,i=t.data;if(n){if(t.type===C.ULP){t.detail.type===eN.ITEM_IMPRESSION?this.handleUlpItemImpressions(t.detail):this.handleUlpPostMessages(t.detail);return}switch(n.replace("request-","")){case C.SEND_EV:this.handleSendEv(i);break;case C.INLINE_GEOMETRY:this.handleInlineGeometry();break;case C.IFRAME_HEIGHT_RESIZE:this.handleIframeHeightResize(i);break;case C.END_PREVIEW:this.handleEndPreview();break;case C.CALLBACK:this.handleCallback(i)}}}),tf(this,"handleUlpPostMessages",e=>{let t;if(e.type===eN.ERROR&&ty.includes(e.detail))return this.handleUlpErrorMessage(e.detail),this.contentElement&&(this.contentElement.style.height="0"),null;if(th()||window.dispatchEvent(new Event("flipp-engagement")),this.sdk&&(e.type===eN.SEE_FLYER_ITEM||e.type===eN.SEE_MERCHANT_ITEM||e.type===eN.SEE_ECOM_ITEM)){var n,i;n=e.detail.url,i=this.sdk.platform,eq(k.REQUEST_GO_TO_URL,{url:n},i)}switch(e.type){case eN.CLICK_MEATBALL:case eN.SHARE_ITEM:t=eB(e.detail.itemType);break;case eN.SEE_FLYER_ITEM:case eN.CLIP_FLYER_ITEM:t=H.ItemType.Flyer;break;case eN.SEE_MERCHANT_ITEM:case eN.CLIP_MERCHANT_ITEM:t=H.ItemType.Merchant;break;case eN.SEE_ECOM_ITEM:case eN.CLIP_ECOM_ITEM:t=H.ItemType.Ecom;break;case eN.SEE_ALL_DEALS:this.handleUlpSeeAllDealsClick();return;default:throw Error("ULP message not recognized")}this.handleUlpClick(t,e)}),tf(this,"scrollBeyond",()=>{var e,t,n,i,o,r,s;if(this.hasScrolledBeyond||(this.hasScrolledBeyond=!0,!this.data.storefront))return null;let a={sfmlUUID:null!==(n=this.data.storefront.sfml_uuid)&&void 0!==n?n:"-1",version:null,contentHash:null},l=tv(tg({},eb({schemaId:H.ExperienceScrolledBeyondSlotSchemaId,partnerNameIdentifier:this.publisherNameIdentifier,siteId:this.siteId,zoneId:this.zoneIds[0]||0,options:this.options,postalCode:null===(e=this.geoData)||void 0===e?void 0:e.postal_code,campaignNameIdentifier:null===(t=this.kevelMetadata)||void 0===t?void 0:t.campaignNameIdentifier})),{storefront:a,merchant:{merchantId:null!==(i=this.data.storefront.merchant_id)&&void 0!==i?i:-1},decision:eI(eW(this.data,this.siteId,this.zoneIds[0]||0,this.positionIndex,this.getCustomUrl())),height:this.getHeight(),expansionCount:this.expandCount,flyer:{flyerId:null!==(o=this.data.storefront.flyer_id)&&void 0!==o?o:-1,flyerRunId:null!==(r=this.data.storefront.flyer_run_id)&&void 0!==r?r:-1,flyerTypeId:null!==(s=this.data.storefront.flyer_type_id)&&void 0!==s?s:-1,storeId:null,premium:!0}});J.enqueue(l)}),this.targetEl=e,this.publisherNameIdentifier=t,this.data=n,this.options=i,this.keywords=i.sdkConfig?[...d,...eR()]:d,this.resizeCallback=o,this.handlePreviewEnded=a,this.siteId=r,this.zoneIds=s,this._preview=null!==(p=i.preview)&&void 0!==p&&p,this.geoData=l,this.sdk=i.sdkConfig?tv(tg({},i.sdkConfig),{features:S}):null,this.insideNativeMobileApp=null!==(u=!!this.sdk||i.isNativeGAMWebview||this.options.isMRAID)&&void 0!==u&&u,this.intersectionObserver=e0()&&!this.insideNativeMobileApp,this.positionIndex=c}}function tb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let tw=[4309,641];class tE{callSlotFillResultCallback(e){this.options.slotFillResultCallback&&this.options.slotFillResultCallback(e)}completeCountdown(){if(void 0===this.countdownExperience)return null;let e=this.experiences[this.countdownExperience];e.preview?(e.handleEndPreview(),this.appendPreview()):e.requestExpand(),this.stopCountdown()}stopCountdown(){return this.countdownInterval&&window.clearInterval(this.countdownInterval),void 0!==this.countdownExperience&&this.experiences[this.countdownExperience].sendCountdownState(),this.countdownInterval=void 0,this.countdownExperience=void 0,this.countdownStart=void 0,null}startCountdown(e){let t=this.getDwellDuration(e)/this.getDwellSteps(e);return this.countdownExperience=e,this.countdownStart=Date.now(),this.tickCountdown(),this.countdownInterval=window.setInterval(this.tickCountdown,t),null}getDwellDuration(e){var t;let n=null===(t=this.decisionPayload)||void 0===t?void 0:t.decisions.inline[e].contents[0].data.customData;return n.dwellTimerMs?ed(n.dwellTimerMs||3e3,3e3):3e3}getDwellSteps(e){var t;let n=null===(t=this.decisionPayload)||void 0===t?void 0:t.decisions.inline[e].contents[0].data.customData;return n.dwellSteps?ed(n.dwellSteps,3):3}request(){if(this.requested)return null;if(this.targetEl=document.querySelector(this.targetSelector),!this.targetEl)return console.log("No target div found for",this.targetSelector),null;if(this.isNativeMobileApp){var e;e=this.nativeAppDwellExpandCallback,M=()=>this.getExperiences(),N=e}else this.options.isGoogleAmp||this.options.disableLazyLoading?this.getExperiences():(e4(this.targetEl,()=>this.getExperiences(),this.options.rootElement),this.options.isMRAID&&(P=this.nativeAppDwellExpandCallback));this.requested=!0}insertPassback(e){if(!this.targetEl)return null;let t=document.createElement("iframe");t.src="about:blank",t.style.width=this.options.passbackWidth||"100%",t.style.height=this.options.passbackHeight||"600px",t.setAttribute("scrolling","no"),t.setAttribute("frameborder","no"),this.targetEl.appendChild(t),t.contentWindow&&(t.contentWindow.document.open(),t.contentWindow.document.write(e),t.contentWindow.document.close())}addExperience(e=!1,t=0){var n,i,o,r,s;let a=(null===(o=this.decisionPayload)||void 0===o?void 0:null===(i=o.decisions)||void 0===i?void 0:null===(n=i.inline)||void 0===n?void 0:n.length)||0;if(!this.targetEl||!this.decisionPayload||t>=a)return this.options.sdkConfig&&eL(this.options.sdkConfig.platform),e||0!==t||this.callSlotFillResultCallback(!1),null;let l=Object.assign({},this.options,{preview:e}),d=new tI({targetEl:this.targetEl,publisherNameIdentifier:this.publisherNameIdentifier,data:null===(r=this.decisionPayload)||void 0===r?void 0:r.decisions.inline[t],options:l,resizeCallback:this.resizeExperience,siteId:this.siteId,zoneIds:this.zoneIds,handlePreviewEnded:this.handlePreviewEnded,geoData:this.decisionPayload.location,keywords:[...te()],positionIndex:this.experienceLimit>1&&a>1?t+1:null});this.experiences.push(d),d.render(),d.hoverExpandable&&1===a&&(null===(s=d.contentElement)||void 0===s||s.addEventListener("mouseleave",()=>{this.stopCountdown()}));let c=document.createElement("div");c.style.height="0px",c.classList.add("santinel"),this.targetEl.appendChild(c),this.markers.push({el:c,active:!1,index:t}),this.scrollBeyondObserver&&this.dwellObserver&&this.hoverObserver&&(this.scrollBeyondObserver.observe(c),this.options.dwellExpandable&&(d.contentElement&&d.hoverExpandable&&1===a&&(this.dwellObserver=new IntersectionObserver(this.observerCallback,{rootMargin:"-50% 0px 0px 0px"}),this.hoverObserver.observe(d.contentElement)),this.dwellObserver.observe(c))),e||0!==t||this.callSlotFillResultCallback(!0)}appendPreview(){var e,t;let n=(null===(t=this.decisionPayload)||void 0===t?void 0:null===(e=t.decisions)||void 0===e?void 0:e.inline.length)||0;if(!this.decisionPayload||this.experienceLimit<=this.experiences.length||n<=this.experiences.length)return null;this.addExperience(!0,this.experiences.length)}setGAMStyle(e){let t=this.options.startCompact?"610px":"initial",n=`min-height: ${t}; margin: 0 auto !important; height: auto !important; width: 100% !important; 
            display: block !important; max-height: initial !important`,i=window.parent.document;setTimeout(()=>{i.querySelectorAll("[data-freestar-ad], [data-google-query-id]").forEach(e=>{var t,i;1===e.children.length&&(null===(i=e.querySelector("iframe"))||void 0===i?void 0:null===(t=i.contentDocument)||void 0===t?void 0:t.querySelector(".flippxp-frame"))&&e.setAttribute("style",n)})},500);let o=this.options.rootElement;if(o)!function(e,t,n){n.split(",").forEach(n=>{let i=null==e?void 0:e.querySelector(n);i&&1===i.children.length&&i.setAttribute("style",t)})}(i,n,o);else{let t=Math.min(this.options.gamContainerWidth||-1,i.body.clientWidth);!function(e,t,n,i,o){let r=window.frameElement;if(!r)return;let s=r.parentElement,a=null==s?void 0:s.parentElement,l=null==s?void 0:s.children.length,d=null==a?void 0:a.children.length,c=el.getDeviceInfo().type;if(s&&t&&(s.style.width="100%",o&&o>0&&"mobile"!==c&&(s.style.width=`${o}px`)),!t&&a&&1===l&&1===d){a.style.display="none",n(!1);return}if(i&&a&&1===l&&1===d){var p,u;(null==a?void 0:null===(u=a.parentElement)||void 0===u?void 0:null===(p=u.children)||void 0===p?void 0:p.length)===1&&a.parentElement.setAttribute("style",e),a.setAttribute("style",e)}}(n,e,e=>this.callSlotFillResultCallback(e),!!this.options.nestedIframeResizing,t)}}getGeolocatedExperience(e){this.queueRequestMadeBeacon(),(this.options.campaigns?Promise.resolve(JSON.parse(this.options.campaigns)):fetch("https://cdn.ads-flipp.com/flyer-locator-service/campaigns",{method:"POST",credentials:"omit",body:JSON.stringify(e),headers:{"Content-Type":"text/plain"}}).then(e=>(e.ok||(this.callSlotFillResultCallback(!1),this.options.sdkConfig&&eL(this.options.sdkConfig.platform),this.queueFailureBeacon(e)),e.json()))).then(e=>{this.queueSuccessBeacon(e),this.decisionPayload=e;let t=e.decisions&&"object"==typeof e.decisions&&Object.keys(e.decisions).some(t=>t in e.decisions&&e.decisions[t]);if(ti())try{this.setGAMStyle(t)}catch(e){e instanceof Error?Y(e.message,e.stack,window.location.href):K(e)}let n=1179443===this.siteId&&document.getElementById("flyerWidgetLabel");if(t&&n&&(n.style.display="block"),this.options.passbackTag&&(!e.decisions||!e.decisions.inline||e.decisions.inline.length<1||null===e.decisions.inline[0])){this.callSlotFillResultCallback(!1);let e="function"==typeof this.options.passbackTag?this.options.passbackTag():this.options.passbackTag;if("object"==typeof e&&"function"==typeof e.then)return e.then(e=>{if(!e)throw Error(JSON.stringify(e));return this.insertPassback(e),null}).catch(e=>{throw Error("Passback promise fallthrough. Hiding experience: "+(e instanceof Error?e.message:"unknown"))});if("string"==typeof e&&e)this.insertPassback(e);else throw Error("Passback fallthrough. Hiding experience");return}(this.options.nestedIframe&&!e.decisions||!e.decisions.inline||e.decisions.inline.length<1||null===e.decisions.inline[0])&&tn(0,!!this.options.nestedIframeShared,!!this.options.nestedIframeFullBleed),this.addExperience(),e.decisions.inline&&e.decisions.inline.length>1&&this.appendPreview()}).catch(e=>(e.message.startsWith("Passback")?console.warn("Flipp Experience failed to load: ",e.message):(G.error("Slot error",e),this.queueErrorBeacon(e)),this.options.nestedIframe&&0===this.experiences.length&&tn(0,!!this.options.nestedIframeShared,!!this.options.nestedIframeFullBleed),this.callSlotFillResultCallback(!1),null))}getExperiences(){var e;let t={divName:"inline",networkId:10922,siteId:this.siteId,adTypes:tw,count:this.experienceLimit};void 0!==this.zoneIds&&null!=this.zoneIds&&this.zoneIds.length>0&&(t.zoneIds=this.zoneIds);let n={},i=null!==(e=new URL(window.location.toString()).searchParams.get("flipp-content-code"))&&void 0!==e?e:this.options.flippContentCode;i&&i.length>0&&(n.contentCode=i.slice(0,32)),this.options.mediaPartnerDescriptiveValueTag&&(n.mediaPartnerDescriptiveValueTag=this.options.mediaPartnerDescriptiveValueTag.slice(0,32)),t.properties=n;let o=[...te(),...tl(td,!0),...eR()],r={placements:[t],url:this.getCanonicalUrl(),keywords:o},s=ei(this.options);return s&&(r.user={key:s}),this.getGeolocatedExperience(r),this.queueRequestContextBeacon(o),null}getCanonicalUrl(){var e;let t=null===(e=document.querySelector("link[rel='canonical']"))||void 0===e?void 0:e.getAttribute("href");if(t)return t;let n=new URL(window.location.href);return n.origin+n.pathname}queueRequestContextBeacon(e){let t=`${location.origin}${location.pathname}`,n=new URLSearchParams(window.location.search),i=0===n.size?[]:Array.from(n.entries());return J.enqueue(eE({partnerNameIdentifier:this.publisherNameIdentifier,siteId:this.siteId,zoneId:this.zoneIds[0]||0,keywords:[...e],category:function(){let e=document.querySelectorAll(e9),t="Unknown";if(!e)return t;let n=e=>{let t=e["@type"];return"Recipe"===t?"Recipe":"NewsArticle"===t?"News":null};return e.forEach(e=>{try{let o=JSON.parse(e.innerText);if(e8(o))o["@graph"].forEach(e=>{var i;t=null!==(i=n(e))&&void 0!==i?i:t});else if(Array.isArray(o))o.forEach(e=>{var i;t=null!==(i=n(e))&&void 0!==i?i:t});else{var i;t=null!==(i=n(o))&&void 0!==i?i:t}}catch(e){}}),t}(),pageUrl:t,queryParams:i,options:this.options,postalCode:ev(),country:ey()})),G.debug("Analytics sendDecisionRequestContext"),null}queueRequestMadeBeacon(){return J.enqueue(ex({partnerNameIdentifier:this.publisherNameIdentifier,siteId:this.siteId,zoneId:this.zoneIds[0]||0,options:this.options,postalCode:ev(),country:ey()})),G.debug("Analytics sendDecisionRequestMade"),null}queueFailureBeacon(e){return J.enqueue(eC({partnerNameIdentifier:this.publisherNameIdentifier,siteId:this.siteId,zoneId:this.zoneIds[0]||0,errorMessage:"Campaigns request failed",responseCode:e.status,options:this.options,postalCode:ev(),country:ey()})),G.debug("Analytics sendDecisionRequestFailure"),null}queueSuccessBeacon(e){var t;let n=e.decisions.inline&&e.decisions.inline[0].contents.length>0,{url:i,campaignNameIdentifier:o}=(e=>{var t,n,i;let o={url:"no-campaign-url-nor-ulp",campaignNameIdentifier:"no-campaign-name-identifier"};if((null===(t=e.decisions)||void 0===t?void 0:t.inline)&&e.decisions.inline.length>0){let t=e.decisions.inline[0].contents[0].data.customData,r=null!==(n=null==t?void 0:t.campaignConfigUrl)&&void 0!==n?n:null==t?void 0:t.ulpUrl;o={url:null!=r?r:"no-campaign-url-nor-ulp",campaignNameIdentifier:null!==(i=null==t?void 0:t.campaignNameIdentifier)&&void 0!==i?i:"no-campaign-name-identifier"}}return o})(e);if(n){let t=e.decisions.inline[0].contents[0].data.customData,n=new URL(window.location.toString());this.experienceLimit=Number(n.searchParams.get("flipp-experience-limit"))||Number(t.experienceLimit)||this.options.experienceLimit||1}let r=this.experienceLimit>1&&(null===(t=e.decisions.inline)||void 0===t?void 0:t.length)>1,s=e.decisions.inline?[{campaignId:e.decisions.inline[0].campaignId,siteId:ed(this.siteId),zoneId:ed(this.zoneIds[0])||0,adId:e.decisions.inline[0].adId,creativeId:e.decisions.inline[0].creativeId,flightId:e.decisions.inline[0].flightId,advertiserId:e.decisions.inline[0].advertiserId,customUrl:n?{string:i}:null,positionIndex:r?{int:1}:null}]:[],a=null==e?void 0:e.location;return J.enqueue(ek({campaignNameIdentifier:o,partnerNameIdentifier:this.publisherNameIdentifier,siteId:this.siteId,zoneId:this.zoneIds[0]||0,country:null==a?void 0:a.country,postalCode:null==a?void 0:a.postal_code,decisions:s,options:this.options})),G.debug("Analytics sendDecisionRequestSuccess"),null}queueErrorBeacon(e){return J.enqueue(eC({partnerNameIdentifier:this.publisherNameIdentifier,siteId:this.siteId,zoneId:this.zoneIds[0]||0,errorMessage:e.message+" - "+(e.stack||""),responseCode:0,options:this.options,postalCode:ev(),country:ey()})),G.debug("Analytics sendDecisionRequestFailure"),null}constructor(e,t,n,i,o){var r;tb(this,"decisionPayload",void 0),tb(this,"experiences",void 0),tb(this,"markers",void 0),tb(this,"requested",void 0),tb(this,"experienceLimit",void 0),tb(this,"targetSelector",void 0),tb(this,"targetEl",void 0),tb(this,"publisherNameIdentifier",void 0),tb(this,"siteId",void 0),tb(this,"zoneIds",void 0),tb(this,"options",void 0),tb(this,"dwellObserver",void 0),tb(this,"scrollBeyondObserver",void 0),tb(this,"hoverObserver",void 0),tb(this,"isNativeMobileApp",void 0),tb(this,"fullyVisibleExperiences",void 0),tb(this,"countdownExperience",void 0),tb(this,"countdownStart",void 0),tb(this,"countdownInterval",void 0),tb(this,"startCountdownFunctions",new Map),tb(this,"slotFillResultCallback",void 0),tb(this,"startCountdownWithMap",e=>{var t;return this.startCountdownFunctions.has(e)||this.startCountdownFunctions.set(e,()=>this.startCountdown(e)),null!==(t=this.startCountdownFunctions.get(e))&&void 0!==t?t:()=>null}),tb(this,"tickCountdown",()=>{if(void 0===this.countdownStart||void 0===this.countdownExperience)return null;let e=Date.now()-this.countdownStart,t=this.getDwellDuration(this.countdownExperience),n=this.experiences[this.countdownExperience],i=t/this.getDwellSteps(this.countdownExperience)+.01;n.sendCountdownState(this.countdownStart+t,i),e>=t&&this.completeCountdown()}),tb(this,"hoverCallback",e=>(e.forEach((e,t)=>{let n=e.target;e.isIntersecting?(this.fullyVisibleExperiences.push(t),n.addEventListener("mouseover",this.startCountdownWithMap(t))):(this.fullyVisibleExperiences=this.fullyVisibleExperiences.filter(e=>t!==e),this.markers[t].active||n.removeEventListener("mouseover",this.startCountdownWithMap(t)))}),null)),tb(this,"observerCallback",e=>{e.forEach(e=>{let t=e.target;this.markers.forEach(n=>{n.el===t&&(n.active=e.isIntersecting)})});let t=!1;this.markers.forEach((e,n)=>{let i=this.experiences[n],o=n>0?this.experiences[n-1]:null,r=0===n,s=o&&o.expandCount>=1;if((!i.preview&&i.expandCount<1||i.preview&&(s||r))&&!t&&e.active)this.countdownExperience!==n&&(this.stopCountdown(),i.expandCount<1&&(i.hoverExpandable&&i.contentElement&&1===this.experiences.length?i.contentElement.addEventListener("mouseover",this.startCountdownWithMap(n)):this.startCountdown(n))),t=!0;else if(!e.active){var a;this.fullyVisibleExperiences.includes(n)||null===(a=i.contentElement)||void 0===a||a.removeEventListener("mouseover",this.startCountdownWithMap(n)),this.countdownExperience===n&&this.stopCountdown()}})}),tb(this,"nativeAppDwellExpandCallback",e=>{if(!this.options.dwellExpandable||0===this.experiences.length)return null;let t=this.experiences[0],n=e.top+1+e.height>=t.getHeight()&&e.height>=e.screenHeight/2;if(t.expandCount<1&&n)0!==this.countdownExperience&&(this.stopCountdown(),t.expandCount<1&&(t.hoverExpandable&&t.contentElement&&1===this.experiences.length?t.contentElement.addEventListener("mouseover",this.startCountdownWithMap(0)):this.startCountdown(0)));else if(!n){var i;this.fullyVisibleExperiences.includes(0)||null===(i=t.contentElement)||void 0===i||i.removeEventListener("mouseover",this.startCountdownWithMap(0)),0===this.countdownExperience&&this.stopCountdown()}return null}),tb(this,"scrollBeyondCallback",e=>(e.filter(e=>e.isIntersecting).map(e=>this.markers.find(t=>t.el===e.target)).filter(e=>e&&this.experiences[e.index]).forEach(e=>{var t;return this.experiences[null!==(t=null==e?void 0:e.index)&&void 0!==t?t:0].scrollBeyond()}),null)),tb(this,"resizeExperience",(e,t)=>(this.options.nestedIframe&&this.targetEl&&e.contentElement&&(e.contentElement.style.height=`${t}px`,tn(this.targetEl.offsetHeight,!!this.options.nestedIframeShared,!!this.options.nestedIframeFullBleed)),null)),tb(this,"handlePreviewEnded",()=>(this.appendPreview(),null)),tb(this,"sendImpression",({cpm:e,postalCode:t,campaignId:n})=>{if(J.enqueue(eS({partnerNameIdentifier:this.publisherNameIdentifier,siteId:this.siteId,zoneId:this.zoneIds[0]||0,options:this.options,cpm:e,postalCode:t,campaignId:n})),G.debug("Analytics sendSlotimpressionExperience"),this.options.campaigns){let e=JSON.parse(this.options.campaigns),t=e.decisions.inline[0];eT.addTagsFromCampaignResponse(t,{startCompact:!!this.options.startCompact},e.location),eT.sendServedImpression()}return null}),this.targetSelector=e,this.publisherNameIdentifier=t?t.toString():"undefined",this.siteId=ed(n),this.zoneIds=i.map(e=>ed(e)),this.options=o,this.requested=!1,this.experiences=[],this.markers=[],this.isNativeMobileApp=null!==(r=!!o.sdkConfig||o.isNativeGAMWebview)&&void 0!==r&&r;let s=new URL(window.location.toString());this.experienceLimit=Number(s.searchParams.get("flipp-experience-limit"))||o.experienceLimit||1,this.fullyVisibleExperiences=[],this.options.isMRAID||this.isNativeMobileApp||!e0()?(this.dwellObserver=null,this.scrollBeyondObserver=null,this.hoverObserver=null):(this.dwellObserver=new IntersectionObserver(this.observerCallback,{rootMargin:"-70% 0px -5% 0px"}),this.scrollBeyondObserver=new IntersectionObserver(this.scrollBeyondCallback,{rootMargin:"-95% 0px 0px 0px"}),this.hoverObserver=new IntersectionObserver(this.hoverCallback,{threshold:1})),this.slotFillResultCallback="function"==typeof o.slotFillResultCallback?o.slotFillResultCallback:void 0}}function tx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class tC{checkReady(){let e=this.slotsAllInDocument();return!!(e&&("interactive"===document.readyState||"complete"===document.readyState)||this.anySlotInDocument()&&"complete"===document.readyState)||(e||console.info("Missing slot target div at state",document.readyState),!1)}anySlotInDocument(){return this.slots.some(e=>document.querySelector(e.targetSelector))}slotsAllInDocument(){return this.slots.every(e=>!!document.querySelector(e.targetSelector))}load(){return this.slots.forEach(e=>e.request()),null}register(e,t,n,i,o={}){let r=new tE(e,t,n,i,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){tx(e,t,n[t])})}return e}({},window.flippxp.settings||{},o));return this.slots.push(r),this.checkReady()?this.load():this.waitingForDocument||(this.waitingForDocument=!0,document.addEventListener("readystatechange",this.handleReadyStateChange)),r}constructor(){tx(this,"slots",void 0),tx(this,"waitingForDocument",void 0),tx(this,"handleReadyStateChange",()=>(this.checkReady()&&(this.waitingForDocument=!1,this.load(),document.removeEventListener("readystatechange",this.handleReadyStateChange)),null)),this.waitingForDocument=!1,this.slots=[]}}let tk=({targetSelector:e,publisherNameIdentifier:t,siteId:n,zoneIds:i,options:o})=>{let r=document.querySelector(e),s=new MutationObserver(()=>{let a=document.querySelector(e);a&&a!==r&&(r=a,a.querySelector(".flippxp-frame")||(s.disconnect(),window.flippxp.registerSlot(e,t,n,i,o)))}),a=o.spaObserveTargetSelector?document.querySelector(o.spaObserveTargetSelector):null;(a||document.body)&&s.observe(null!=a?a:document.body,{childList:!0,subtree:!0})};try{let t=!1;for(window.handleMessageFromNative=function(e){var t=e.detail;switch(e.type){case k.EXPERIENCE_LOAD:t.context_list&&t.context_list.length>0&&(T=t.context_list),M(),t.features.length>0&&(S=eU(t.features));break;case k.EXPERIENCE_VIEWPORT:eD(e)}return null},window.flippxp=window.flippxp||{},window.flippxp.evTag=window.flippxp.evTag||{},window.flippxp.run=window.flippxp.run||[],window.flippxp.debugMode=window.flippxp.debugMode||{},window.flippxp.calculateGeomData=e,window.flippxp.overrideOptions=function(e){let t=new URL(window.location.toString()),n=t.searchParams.get("flipp-test-dwell-expandable"),i=ed(t.searchParams.get("flipp-test-experience-limit"),0),o=t.searchParams.get("flipp-test-start-compact"),r=t.searchParams.get("flipp-test-nested-iframe-resizing"),s=t.searchParams.get("flipp-test-expand-on-read-more"),a=t.searchParams.get("flipp-test-root-element"),l=t.searchParams.get("flipp-test-nested-iframe-shared"),d=t.searchParams.get("flipp-test-wide-compact"),c=t.searchParams.get("flipp-test-wide-compact-background-color"),p=e1({},e);return null!==n&&(p=e2(e1({},p),{dwellExpandable:"true"===n})),i&&(p=e2(e1({},p),{experienceLimit:Math.max(1,i)})),null!==o&&(p=e2(e1({},p),{startCompact:"true"===o})),null!==r&&(p=e2(e1({},p),{nestedIframeResizing:"true"===r})),null!==s&&(p=e2(e1({},p),{expandOnReadMore:"true"===s})),null!==a&&(p=e2(e1({},p),{rootElement:a})),null!==l&&(p=e2(e1({},p),{nestedIframeShared:"true"===l})),null!==d&&null!==c&&(p=e2(e1({},p),{wideCompact:"true"===d,wideCompactBackgroundColor:c})),p},window.flippxp.vimpTrackerFunc=window.flippxp.vimpTrackerFunc||(()=>{window!==window.parent&&window.parent.postMessage({type:C.VIMP},"*")}),window.flippxp.cookieSynced=window.flippxp.cookieSynced||!1,window.flippxp.registerSlot=function(e,n,i,o,r={}){var s,a,l,d,c;if(t||(J.prodAnalytics=!!(null===(a=window.flippxp.debugMode)||void 0===a?void 0:a.prodAnalytics),t=!0,J.enqueue(ew({partnerNameIdentifier:n,siteId:i,zoneId:o[0]||0,options:r,postalCode:null===(l=window.flippxp.geo)||void 0===l?void 0:l.postal_code,country:null===(d=window.flippxp.geo)||void 0===d?void 0:d.country})),G.debug("Analytics sendAppInitialized")),eT.reset(),1179443===i){let e=document.getElementById("flyerWidgetLabel");e&&(e.style.display="none")}return(null!==(c=r.singlePageApp)&&void 0!==c?c:null===(s=window.flippxp.settings)||void 0===s?void 0:s.singlePageApp)&&tk({targetSelector:e,publisherNameIdentifier:n,siteId:i,zoneIds:o,options:r}),window.flippxp.slotManager=window.flippxp.slotManager||new tC,window.flippxp.slotManager.register(e,n,i,o||[],window.flippxp.overrideOptions(r))};window.flippxp.run.length>0;){let e=window.flippxp.run.shift();eZ()||"function"!=typeof e||e()}window.flippxp.run.push=function(e){return eZ()||"function"!=typeof e||e(),null}}catch(e){K(e)}}();
//# sourceMappingURL=flipptag.no_ua_parser.js.map
